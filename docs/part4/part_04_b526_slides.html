<!DOCTYPE html>
<html lang="en"><head>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.3.361">

  <meta name="author" content="Meike Niederhausen, PhD &amp; Jessica Minnier, PhD">
  <meta name="dcterms.date" content="2026-01-29">
  <title>4: mutate() &amp; summarize()</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto.css">
  <link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">4: <code>mutate()</code>, <code>case_when()</code>, <code>summarize()</code>, <code>across()</code>, <code>factor()</code>, more <code>ggplot2</code></h1>
  <p class="subtitle">BSTA 526: R Programming for Health Data Science</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Meike Niederhausen, PhD &amp; Jessica Minnier, PhD 
</div>
        <p class="quarto-title-affiliation">
            OHSU-PSU School of Public Health
          </p>
    </div>
</div>

  <p class="date">2026-01-29</p>
</section>
<section>
<section id="welcome-to-r-programming-part-4" class="title-slide slide level1 center" data-number="1">
<h1><span class="header-section-number">1</span> Welcome to R Programming: Part 4!</h1>
<p>Today we will cover creating new variables and summarizing existing variables.</p>
<p><br></p>
<p>Before you get started:</p>
<blockquote>
<p>Remember to save this notebook under a new name, such as <code>part_04_b526_YOURNAME.qmd</code>.</p>
</blockquote>
<p><br></p>
<ul>
<li>Load the packages &amp; <code>smoke_complete.xlsx</code> data in the setup code chunk</li>
</ul>
</section>
<section id="learning-objectives" class="slide level2" data-number="1.1">
<h2><span class="header-section-number">1.1</span> Learning Objectives</h2>
<ul>
<li><strong>Learn</strong> and apply <code>mutate()</code> to change the data type of a variable</li>
<li><strong>Apply</strong> <code>mutate()</code> to calculate a new variable based on other variables in a <code>data.frame</code>.</li>
<li><strong>Apply</strong> <code>case_when</code> in a <code>mutate()</code> statement to make a continuous variable categorical</li>
<li><strong>Learn</strong> how to <code>mutate()</code> <code>across()</code> multiple columns at once.</li>
<li><strong>Learn</strong> how to <code>summarize()</code> data with <code>group_by()</code> to summarize within categories</li>
<li><strong>Learn</strong> how to <code>summarize()</code> data with multiple columns and functions at once, also with <code>across()</code>.</li>
<li><strong>Learn</strong> about the factor variable type and how they differ from character vectors</li>
<li><strong>Learn</strong> to change scales and palettes of ggplots.</li>
</ul>
</section></section>
<section>
<section id="working-with-columns-variables" class="title-slide slide level1 center" data-number="2">
<h1><span class="header-section-number">2</span> Working with columns (variables)</h1>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="image/dplyr_mutate.png" style="width:65.0%"></p>
<figcaption><a href="https://allisonhorst.com/r-packages-functions">Image from Allison Horst</a></figcaption>
</figure>
</div>
</section>
<section id="rename-columns" class="slide level2" data-number="2.1">
<h2><span class="header-section-number">2.1</span> <code>rename()</code> columns</h2>
<ul>
<li>A simple handy operation which does exactly what it sounds like.</li>
<li>The main thing you need to remember is:</li>
</ul>
<blockquote>
<p><code>rename(NEWNAME = OLDNAME)</code></p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">names</span>(smoke_complete)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "primary_diagnosis"           "tumor_stage"                
 [3] "age_at_diagnosis"            "vital_status"               
 [5] "morphology"                  "days_to_death"              
 [7] "state"                       "tissue_or_organ_of_origin"  
 [9] "days_to_birth"               "site_of_resection_or_biopsy"
[11] "days_to_last_follow_up"      "cigarettes_per_day"         
[13] "years_smoked"                "gender"                     
[15] "year_of_birth"               "race"                       
[17] "ethnicity"                   "year_of_death"              
[19] "bcr_patient_barcode"         "disease"                    </code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>smoke_complete <span class="sc">%&gt;%</span> </span>
<span id="cb3-2"><a href="#cb3-2"></a>  <span class="fu">rename</span>(<span class="at">STAGE =</span> tumor_stage) <span class="sc">%&gt;%</span></span>
<span id="cb3-3"><a href="#cb3-3"></a>  <span class="fu">names</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "primary_diagnosis"           "STAGE"                      
 [3] "age_at_diagnosis"            "vital_status"               
 [5] "morphology"                  "days_to_death"              
 [7] "state"                       "tissue_or_organ_of_origin"  
 [9] "days_to_birth"               "site_of_resection_or_biopsy"
[11] "days_to_last_follow_up"      "cigarettes_per_day"         
[13] "years_smoked"                "gender"                     
[15] "year_of_birth"               "race"                       
[17] "ethnicity"                   "year_of_death"              
[19] "bcr_patient_barcode"         "disease"                    </code></pre>
</div>
</div>
</section>
<section id="mutate-adds-columns-to-a-dataset" class="slide level2" data-number="2.2">
<h2><span class="header-section-number">2.2</span> <code>mutate()</code> adds columns to a dataset</h2>
<ul>
<li><code>mutate()</code> creates new columns (variables), which are usually based on existing columns or are entirely new data</li>
<li>It does not change the data within the existing columns
<ul>
<li>(unless you overwrite them with <code>mutate()</code>)</li>
</ul></li>
</ul>
<p><br></p>
<ul>
<li><code>mutate()</code> is similar to adding a formula in Excel to calculate the value of a new column based on previous columns.</li>
<li>You can do lots of things such as:
<ul>
<li>subtract one column from another</li>
<li>convert the units of one column to new units (such as days to years)</li>
<li>change the capitalization of categories in a variable</li>
<li>recode a continuous variable to be a categorical one</li>
</ul></li>
</ul>
</section>
<section id="mutate-to-calculate-a-new-variable-based-on-others" class="slide level2" data-number="2.3">
<h2><span class="header-section-number">2.3</span> <code>mutate()</code> to calculate a new variable based on others</h2>
<ul>
<li>Note that we use <code>=</code> inside mutate, not <code>==</code> or <code>&lt;-</code>:
<ul>
<li>we are not creating a logical operation,</li>
<li>nor are we assigning something to an object name.</li>
</ul></li>
</ul>
<h3 data-number="2.3.1" id="example-1-calculate-the-sum-of-age_at_diagnoses-and-days_to_death-to-get-the-age_at_death."><span class="header-section-number">2.3.1</span> Example 1: calculate the sum of <code>age_at_diagnoses</code> and <code>days_to_death</code> to get the <code>age_at_death</code>.</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>smoke_complete <span class="sc">%&gt;%</span> </span>
<span id="cb5-2"><a href="#cb5-2"></a>    <span class="fu">mutate</span>(<span class="at">age_at_death =</span> age_at_diagnosis <span class="sc">+</span> days_to_death) <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="#cb5-3"></a>  <span class="co"># check:  </span></span>
<span id="cb5-4"><a href="#cb5-4"></a>  <span class="fu">select</span>(age_at_death, age_at_diagnosis, days_to_death) <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  age_at_death age_at_diagnosis days_to_death
         &lt;dbl&gt;            &lt;dbl&gt;         &lt;dbl&gt;
1        24848            24477           371
2        26751            26615           136
3        30475            28171          2304
4           NA            27154            NA
5           NA            23370            NA</code></pre>
</div>
</div>
<p><br></p>
<h3 data-number="2.3.2" id="example-2-convert-age_at_diagnosis-from-age-in-days-to-age-in-years."><span class="header-section-number">2.3.2</span> Example 2: convert <code>age_at_diagnosis</code> from age in <em>days</em> to age in <em>years</em>.**</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>smoke_complete <span class="sc">%&gt;%</span> </span>
<span id="cb7-2"><a href="#cb7-2"></a>    <span class="fu">mutate</span>(<span class="at">age_at_diagnosis_yr =</span> age_at_diagnosis<span class="sc">/</span><span class="dv">365</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="#cb7-3"></a>  <span class="co"># check:  </span></span>
<span id="cb7-4"><a href="#cb7-4"></a>  <span class="fu">select</span>(age_at_diagnosis, age_at_diagnosis_yr) <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  age_at_diagnosis age_at_diagnosis_yr
             &lt;dbl&gt;               &lt;dbl&gt;
1            24477                67.1
2            26615                72.9
3            28171                77.2
4            27154                74.4
5            23370                64.0</code></pre>
</div>
</div>
</section>
<section id="multiple-mutate-save-the-new-variables" class="slide level2" data-number="2.4">
<h2><span class="header-section-number">2.4</span> Multiple <code>mutate()</code> &amp; save the new variables</h2>
<ul>
<li>Remember, since we haven’t assigned this new “mutated” data frame to an object name, our work hasn’t been saved.
<ul>
<li>Below we save the new dataset as <code>smoke_new</code>. Look for it in the environment tab.</li>
</ul></li>
<li>Notice also how we can mutate multiple variables at one time by separating the new variables with a <code>,</code>.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>smoke_new <span class="ot">&lt;-</span> smoke_complete <span class="sc">%&gt;%</span> </span>
<span id="cb9-2"><a href="#cb9-2"></a>    <span class="fu">mutate</span>(</span>
<span id="cb9-3"><a href="#cb9-3"></a>      <span class="at">age_at_death =</span> age_at_diagnosis <span class="sc">+</span> days_to_death,  <span class="co">#1st new var</span></span>
<span id="cb9-4"><a href="#cb9-4"></a>      <span class="at">age_at_diagnosis_yr =</span> age_at_diagnosis<span class="sc">/</span><span class="dv">365</span>        <span class="co">#2nd new var</span></span>
<span id="cb9-5"><a href="#cb9-5"></a>      )</span>
<span id="cb9-6"><a href="#cb9-6"></a></span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="fu">glimpse</span>(smoke_new)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,152
Columns: 22
$ primary_diagnosis           &lt;chr&gt; "C34.1", "C34.1", "C34.3", "C34.1", "C34.1…
$ tumor_stage                 &lt;chr&gt; "stage ia", "stage ib", "stage ib", "stage…
$ age_at_diagnosis            &lt;dbl&gt; 24477, 26615, 28171, 27154, 23370, 19025, …
$ vital_status                &lt;chr&gt; "dead", "dead", "dead", "alive", "alive", …
$ morphology                  &lt;chr&gt; "8070/3", "8070/3", "8070/3", "8083/3", "8…
$ days_to_death               &lt;dbl&gt; 371, 136, 2304, NA, NA, 345, 716, 2803, 97…
$ state                       &lt;chr&gt; "live", "live", "live", "live", "live", "l…
$ tissue_or_organ_of_origin   &lt;chr&gt; "C34.1", "C34.1", "C34.3", "C34.1", "C34.1…
$ days_to_birth               &lt;dbl&gt; -24477, -26615, -28171, -27154, -23370, -1…
$ site_of_resection_or_biopsy &lt;chr&gt; "C34.1", "C34.1", "C34.3", "C34.1", "C34.1…
$ days_to_last_follow_up      &lt;dbl&gt; NA, NA, 2099, 3747, 3576, NA, NA, 1810, 95…
$ cigarettes_per_day          &lt;dbl&gt; 10.9589041, 2.1917808, 1.6438356, 1.095890…
$ years_smoked                &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, 26, NA…
$ gender                      &lt;chr&gt; "male", "male", "female", "male", "female"…
$ year_of_birth               &lt;dbl&gt; 1936, 1931, 1927, 1930, 1942, 1953, 1932, …
$ race                        &lt;chr&gt; "white", "asian", "white", "white", "not r…
$ ethnicity                   &lt;chr&gt; "not hispanic or latino", "not hispanic or…
$ year_of_death               &lt;dbl&gt; 2004, 2003, NA, NA, NA, 2005, 2006, NA, NA…
$ bcr_patient_barcode         &lt;chr&gt; "TCGA-18-3406", "TCGA-18-3407", "TCGA-18-3…
$ disease                     &lt;chr&gt; "LUSC", "LUSC", "LUSC", "LUSC", "LUSC", "L…
$ age_at_death                &lt;dbl&gt; 24848, 26751, 30475, NA, NA, 19370, 27654,…
$ age_at_diagnosis_yr         &lt;dbl&gt; 67.06027, 72.91781, 77.18082, 74.39452, 64…</code></pre>
</div>
</div>
<h3 data-number="2.4.1" id="check"><span class="header-section-number">2.4.1</span> Check</h3>
<ul>
<li>We can check the new variable <code>age_at_diagnosis_yr</code> by plotting it with age_at_diagnosis in a scatterplot,
<ul>
<li>seeing that they are indeed a simple linear transformation of each other:</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="fu">ggplot</span>(smoke_new) <span class="sc">+</span></span>
<span id="cb11-2"><a href="#cb11-2"></a>  <span class="fu">aes</span>(<span class="at">x =</span> age_at_diagnosis, </span>
<span id="cb11-3"><a href="#cb11-3"></a>      <span class="at">y =</span> age_at_diagnosis_yr) <span class="sc">+</span></span>
<span id="cb11-4"><a href="#cb11-4"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="output_figs/unnamed-chunk-6-1.png" width="768"></p>
</div>
</div>
</section>
<section id="challenge-1-10-mins" class="slide level2" data-number="2.5">
<h2><span class="header-section-number">2.5</span> Challenge 1 (~10 mins)</h2>
<ol type="1">
<li><p>Discuss: Suppose we wanted to convert <code>vital_status</code> to a binary 0/1 variable. What is the difference between the two variables created in the code below, and why do each of the versions work? Interpret the results from the <code>tabyl()</code> function (from the <code>janitor</code> package).</p></li>
<li><p>Create a variable called <code>cigarettes_total</code> by multiplying <code>cigarettes_per_day</code> by <code>-days_to_birth</code> below.</p></li>
<li><p>Create a binary variable <code>cigarettes_high</code> that denotes whether total number of cigarettes is greater than the mean of <code>cigarettes_total</code>.</p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="co"># change eval = true</span></span>
<span id="cb12-2"><a href="#cb12-2"></a></span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="co"># 1. Discuss the code below:</span></span>
<span id="cb12-4"><a href="#cb12-4"></a>smoke_new <span class="ot">&lt;-</span> smoke_complete <span class="sc">%&gt;%</span></span>
<span id="cb12-5"><a href="#cb12-5"></a>  <span class="fu">mutate</span>(</span>
<span id="cb12-6"><a href="#cb12-6"></a>    <span class="at">alive =</span> (vital_status <span class="sc">==</span> <span class="st">"alive"</span>),</span>
<span id="cb12-7"><a href="#cb12-7"></a>    <span class="at">alive2 =</span> <span class="dv">1</span><span class="sc">*</span>(vital_status <span class="sc">==</span> <span class="st">"alive"</span>)</span>
<span id="cb12-8"><a href="#cb12-8"></a>  )</span>
<span id="cb12-9"><a href="#cb12-9"></a></span>
<span id="cb12-10"><a href="#cb12-10"></a>smoke_new <span class="sc">%&gt;%</span> <span class="fu">glimpse</span>()</span>
<span id="cb12-11"><a href="#cb12-11"></a></span>
<span id="cb12-12"><a href="#cb12-12"></a></span>
<span id="cb12-13"><a href="#cb12-13"></a><span class="co"># What does this code tell us?</span></span>
<span id="cb12-14"><a href="#cb12-14"></a>smoke_new <span class="sc">%&gt;%</span> </span>
<span id="cb12-15"><a href="#cb12-15"></a>  <span class="fu">tabyl</span>(alive, alive2)</span>
<span id="cb12-16"><a href="#cb12-16"></a></span>
<span id="cb12-17"><a href="#cb12-17"></a><span class="co"># What does this code tell us?</span></span>
<span id="cb12-18"><a href="#cb12-18"></a>smoke_new <span class="sc">%&gt;%</span> </span>
<span id="cb12-19"><a href="#cb12-19"></a>  <span class="fu">tabyl</span>(vital_status, alive2)</span>
<span id="cb12-20"><a href="#cb12-20"></a></span>
<span id="cb12-21"><a href="#cb12-21"></a><span class="co">#-----------------------------------------------</span></span>
<span id="cb12-22"><a href="#cb12-22"></a><span class="co"># 2. Calculate total number of cigarettes so far</span></span>
<span id="cb12-23"><a href="#cb12-23"></a>smoke_new <span class="ot">&lt;-</span> smoke_new <span class="sc">%&gt;%</span></span>
<span id="cb12-24"><a href="#cb12-24"></a>  <span class="fu">mutate</span>(<span class="at">cigarettes_total =</span> )</span>
<span id="cb12-25"><a href="#cb12-25"></a></span>
<span id="cb12-26"><a href="#cb12-26"></a></span>
<span id="cb12-27"><a href="#cb12-27"></a><span class="co">#-----------------------------------------------</span></span>
<span id="cb12-28"><a href="#cb12-28"></a><span class="co"># 3. Create a binary variable that denotes whether total # cigs is greater than the mean cigarettes_total</span></span>
<span id="cb12-29"><a href="#cb12-29"></a>smoke_new <span class="ot">&lt;-</span> smoke_new <span class="sc">%&gt;%</span></span>
<span id="cb12-30"><a href="#cb12-30"></a>  <span class="fu">mutate</span>(<span class="at">cigarettes_high =</span> )</span>
<span id="cb12-31"><a href="#cb12-31"></a></span>
<span id="cb12-32"><a href="#cb12-32"></a><span class="co"># check this makes sense</span></span>
<span id="cb12-33"><a href="#cb12-33"></a>smoke_new <span class="sc">%&gt;%</span> <span class="fu">tabyl</span>(cigarettes_high)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section>
<section>
<section id="factor-variables" class="title-slide slide level1 center" data-number="3">
<h1><span class="header-section-number">3</span> <code>factor</code> variables</h1>

</section>
<section id="factor-variables-1" class="slide level2" data-number="3.1">
<h2><span class="header-section-number">3.1</span> <code>factor</code> variables</h2>
<ul>
<li><code>factor</code>s are how R represents <em>categorical data</em>.</li>
<li>For the most part, you can use <code>character</code> and <code>factor</code> variables interchangeably for categorical data.</li>
<li>The main differences are that <code>factor</code>s
<ul>
<li>define the permissible values (categories) for a variable with the <code>levels</code> argument</li>
<li>they also define the order in which these values are displayed.</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>character_vector <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Dog"</span>, <span class="st">"Dog"</span>, <span class="st">"Cat"</span>, <span class="st">"Mouse"</span>)</span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="fu">table</span>(character_vector)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>character_vector
  Cat   Dog Mouse 
    1     2     1 </code></pre>
</div>
</div>
<ul>
<li>Use the <code>factor()</code> function to convert a character vector into a factor vector
<ul>
<li>Make sure to include the argument called <code>levels</code> to define the permissible values</li>
</ul></li>
</ul>
<p><em>Note: highly recommend this <a href="https://www.youtube.com/watch?v=bBfZFasd61c">short video on factors by Prof Kelly Bodwin</a>.</em></p>
</section>
<section id="levels-of-a-factor" class="slide level2" data-number="3.2">
<h2><span class="header-section-number">3.2</span> <code>levels</code> of a <code>factor</code></h2>
<ul>
<li>The <code>levels</code> of a factor are the permissible values in a <code>factor</code>.</li>
<li>The order of the <code>levels</code> control the order in which the values appear in tables and on the axes in a plot.</li>
<li>You can find out the levels of a factor variable with the function <code>levels()</code> or <code>table()</code> also gives you a clue. The <code>tabyl()</code> function in the <code>janitor</code> package also shows factors in their order.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>factor_vector <span class="ot">&lt;-</span> <span class="fu">factor</span>(character_vector)</span>
<span id="cb15-2"><a href="#cb15-2"></a></span>
<span id="cb15-3"><a href="#cb15-3"></a><span class="co"># what are the levels of this vector?</span></span>
<span id="cb15-4"><a href="#cb15-4"></a><span class="fu">levels</span>(factor_vector)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Cat"   "Dog"   "Mouse"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="co"># specify our own ordering of levels</span></span>
<span id="cb17-2"><a href="#cb17-2"></a>factor_vector2 <span class="ot">&lt;-</span> <span class="fu">factor</span>(character_vector, </span>
<span id="cb17-3"><a href="#cb17-3"></a>                        <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Dog"</span>, <span class="st">"Cat"</span>, <span class="st">"Mouse"</span>))</span>
<span id="cb17-4"><a href="#cb17-4"></a></span>
<span id="cb17-5"><a href="#cb17-5"></a><span class="fu">levels</span>(factor_vector2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Dog"   "Cat"   "Mouse"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="fu">table</span>(factor_vector)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>factor_vector
  Cat   Dog Mouse 
    1     2     1 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="fu">table</span>(factor_vector2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>factor_vector2
  Dog   Cat Mouse 
    2     1     1 </code></pre>
</div>
</div>
<p><strong>Being able to order <code>levels</code> is the main reason to use <code>factors</code>, at least in plotting and doing counts.</strong></p>
</section>
<section id="mini-challenge-1" class="slide level2" data-number="3.3">
<h2><span class="header-section-number">3.3</span> Mini-challenge 1</h2>
<ol type="1">
<li>Change the order of <code>factor_vector</code> to be “Mouse”, “Cat”, “Dog”.</li>
<li>Verify that you did it correctly by calling <code>tabyl()</code>.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>factor_vector <span class="ot">&lt;-</span> <span class="fu">factor</span>(character_vector, </span>
<span id="cb23-2"><a href="#cb23-2"></a>                        <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Dog"</span>, <span class="st">"Cat"</span>, <span class="st">"Mouse"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="create-factor-variables-using-mutate" class="slide level2" data-number="3.4">
<h2><span class="header-section-number">3.4</span> Create <code>factor</code> variables using <code>mutate</code></h2>
<ul>
<li>We can also use use <code>mutate()</code> to make a <code>character</code> variable a <code>factor</code>.</li>
</ul>
<div class="panel-tabset">
<ul id="tabset-1" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-1-1">Ex 1: Create a <code>factor</code> variable within <code>mutate</code></a></li><li><a href="#tabset-1-2">Ex 2: Order the levels as well</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1">
<ul>
<li>Let’s convert <code>gender</code> from <code>character</code> into <code>factor</code>.</li>
<li>Then pipe the output into <code>glimpse()</code> so we can see the variable types.</li>
</ul>
<p><em>Note <code>factor()</code> is the same as <code>as.factor()</code></em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>smoke_complete <span class="sc">%&gt;%</span> </span>
<span id="cb24-2"><a href="#cb24-2"></a>    <span class="co">#reassign the gender variable to be a factor</span></span>
<span id="cb24-3"><a href="#cb24-3"></a>    <span class="fu">mutate</span>(<span class="at">gender =</span> <span class="fu">factor</span>(gender)) <span class="sc">%&gt;%</span></span>
<span id="cb24-4"><a href="#cb24-4"></a>    <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,152
Columns: 20
$ primary_diagnosis           &lt;chr&gt; "C34.1", "C34.1", "C34.3", "C34.1", "C34.1…
$ tumor_stage                 &lt;chr&gt; "stage ia", "stage ib", "stage ib", "stage…
$ age_at_diagnosis            &lt;dbl&gt; 24477, 26615, 28171, 27154, 23370, 19025, …
$ vital_status                &lt;chr&gt; "dead", "dead", "dead", "alive", "alive", …
$ morphology                  &lt;chr&gt; "8070/3", "8070/3", "8070/3", "8083/3", "8…
$ days_to_death               &lt;dbl&gt; 371, 136, 2304, NA, NA, 345, 716, 2803, 97…
$ state                       &lt;chr&gt; "live", "live", "live", "live", "live", "l…
$ tissue_or_organ_of_origin   &lt;chr&gt; "C34.1", "C34.1", "C34.3", "C34.1", "C34.1…
$ days_to_birth               &lt;dbl&gt; -24477, -26615, -28171, -27154, -23370, -1…
$ site_of_resection_or_biopsy &lt;chr&gt; "C34.1", "C34.1", "C34.3", "C34.1", "C34.1…
$ days_to_last_follow_up      &lt;dbl&gt; NA, NA, 2099, 3747, 3576, NA, NA, 1810, 95…
$ cigarettes_per_day          &lt;dbl&gt; 10.9589041, 2.1917808, 1.6438356, 1.095890…
$ years_smoked                &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, 26, NA…
$ gender                      &lt;fct&gt; male, male, female, male, female, male, ma…
$ year_of_birth               &lt;dbl&gt; 1936, 1931, 1927, 1930, 1942, 1953, 1932, …
$ race                        &lt;chr&gt; "white", "asian", "white", "white", "not r…
$ ethnicity                   &lt;chr&gt; "not hispanic or latino", "not hispanic or…
$ year_of_death               &lt;dbl&gt; 2004, 2003, NA, NA, NA, 2005, 2006, NA, NA…
$ bcr_patient_barcode         &lt;chr&gt; "TCGA-18-3406", "TCGA-18-3407", "TCGA-18-3…
$ disease                     &lt;chr&gt; "LUSC", "LUSC", "LUSC", "LUSC", "LUSC", "L…</code></pre>
</div>
</div>
<ul>
<li>One thing to notice: we are doing something called <strong><em>reassignment</em></strong> here.
<ul>
<li>We’re taking the previous values of our variable (<code>gender</code>),</li>
<li>doing something to it (making it a <code>factor</code>), and</li>
<li>then reassigning the variable <code>gender</code> to our fixed set of values.</li>
</ul></li>
</ul>
</div>
<div id="tabset-1-2">
<p><em>Change the order of the levels to first female and then male. </em></p>
<ul>
<li>Assign the levels order using the <code>levels</code> argument in <code>factor()</code>.</li>
<li>Show the order of the levels by piping the output into <code>tabyl()</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>smoke_complete <span class="sc">%&gt;%</span> </span>
<span id="cb26-2"><a href="#cb26-2"></a>    <span class="co">#reassign the gender variable to be a factor</span></span>
<span id="cb26-3"><a href="#cb26-3"></a>    <span class="fu">mutate</span>(<span class="at">gender =</span> <span class="fu">factor</span>(gender, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"female"</span>, <span class="st">"male"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb26-4"><a href="#cb26-4"></a>    <span class="fu">tabyl</span>(gender)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> gender   n   percent
 female 366 0.3177083
   male 786 0.6822917</code></pre>
</div>
</div>
<p>Notice that the <code>female</code> value is before the <code>male</code>, which is what we wanted.</p>
</div>
</div>
</div>
</section>
<section id="ggplot2-factor-variables" class="slide level2" data-number="3.5">
<h2><span class="header-section-number">3.5</span> <code>ggplot2</code> &amp; <code>factor</code> variables</h2>
<ul>
<li>Remember, <code>vital_status</code> is a <code>character</code> vector</li>
<li>If we do not care about the order of the categories, we can use it as is when creating figures.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a><span class="co"># create our data, save as a new df smoke_new</span></span>
<span id="cb28-2"><a href="#cb28-2"></a>smoke_new <span class="ot">&lt;-</span> smoke_complete <span class="sc">%&gt;%</span></span>
<span id="cb28-3"><a href="#cb28-3"></a>  <span class="fu">mutate</span>(</span>
<span id="cb28-4"><a href="#cb28-4"></a>    <span class="at">alive =</span> (vital_status <span class="sc">==</span> <span class="st">"alive"</span>),</span>
<span id="cb28-5"><a href="#cb28-5"></a>    <span class="at">alive2 =</span> <span class="dv">1</span><span class="sc">*</span>(vital_status <span class="sc">==</span> <span class="st">"alive"</span>),</span>
<span id="cb28-6"><a href="#cb28-6"></a>    <span class="at">cigarettes_total =</span> <span class="sc">-</span>days_to_birth<span class="sc">*</span>cigarettes_per_day,</span>
<span id="cb28-7"><a href="#cb28-7"></a>    <span class="at">cigarettes_high =</span> <span class="dv">1</span><span class="sc">*</span>(cigarettes_total <span class="sc">&gt;</span> <span class="fu">mean</span>(cigarettes_total, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb28-8"><a href="#cb28-8"></a>    <span class="at">gender =</span> <span class="fu">factor</span>(gender, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"female"</span>, <span class="st">"male"</span>))</span>
<span id="cb28-9"><a href="#cb28-9"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Create boxplot of <code>cigarettes_total</code> stratified by <code>vital_status</code> (character variable):</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="fu">ggplot</span>(smoke_new) <span class="sc">+</span></span>
<span id="cb29-2"><a href="#cb29-2"></a>  <span class="fu">aes</span>(<span class="at">x =</span> vital_status, </span>
<span id="cb29-3"><a href="#cb29-3"></a>      <span class="at">y =</span> cigarettes_total,</span>
<span id="cb29-4"><a href="#cb29-4"></a>      <span class="at">fill =</span> vital_status) <span class="sc">+</span></span>
<span id="cb29-5"><a href="#cb29-5"></a>  <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="output_figs/box-1.png" width="768"></p>
</div>
</div>
</section>
<section id="add-factor-levels-before-plotting" class="slide level2" data-number="3.6">
<h2><span class="header-section-number">3.6</span> Add <code>factor</code> levels before plotting</h2>
<div class="panel-tabset">
<ul id="tabset-2" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-2-1">Ex: 2 levels</a></li><li><a href="#tabset-2-2">Ex: &gt;2 levels</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1">
<ul>
<li>Perhaps we want to change the order of the <code>vital_status</code> values in our plot.</li>
<li>This is where <code>factor</code> levels are useful.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a>smoke_new <span class="ot">&lt;-</span> smoke_new <span class="sc">%&gt;%</span> </span>
<span id="cb30-2"><a href="#cb30-2"></a>  <span class="fu">mutate</span>(</span>
<span id="cb30-3"><a href="#cb30-3"></a>    <span class="at">vital_status =</span> <span class="fu">factor</span>(vital_status, </span>
<span id="cb30-4"><a href="#cb30-4"></a>                          <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"dead"</span>, <span class="st">"alive"</span>)))</span>
<span id="cb30-5"><a href="#cb30-5"></a></span>
<span id="cb30-6"><a href="#cb30-6"></a><span class="fu">ggplot</span>(smoke_new) <span class="sc">+</span></span>
<span id="cb30-7"><a href="#cb30-7"></a>  <span class="fu">aes</span>(<span class="at">x =</span> vital_status, </span>
<span id="cb30-8"><a href="#cb30-8"></a>      <span class="at">y =</span> cigarettes_total, </span>
<span id="cb30-9"><a href="#cb30-9"></a>      <span class="at">fill =</span> vital_status) <span class="sc">+</span></span>
<span id="cb30-10"><a href="#cb30-10"></a>  <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="output_figs/unnamed-chunk-15-1.png" width="768"></p>
</div>
</div>
</div>
<div id="tabset-2-2">
<p>Let’s look at a variable with more than 2 categories:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a>smoke_new <span class="ot">&lt;-</span> smoke_new <span class="sc">%&gt;%</span> </span>
<span id="cb31-2"><a href="#cb31-2"></a>  <span class="fu">mutate</span>(</span>
<span id="cb31-3"><a href="#cb31-3"></a>    <span class="at">disease_fac =</span> <span class="fu">factor</span>(disease, </span>
<span id="cb31-4"><a href="#cb31-4"></a>                         <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"LUSC"</span>, <span class="st">"BLCA"</span>, <span class="st">"CESC"</span>)))</span>
<span id="cb31-5"><a href="#cb31-5"></a></span>
<span id="cb31-6"><a href="#cb31-6"></a><span class="co"># original disease categories, a character vector</span></span>
<span id="cb31-7"><a href="#cb31-7"></a><span class="fu">ggplot</span>(smoke_new) <span class="sc">+</span></span>
<span id="cb31-8"><a href="#cb31-8"></a>  <span class="fu">aes</span>(<span class="at">x =</span> disease, </span>
<span id="cb31-9"><a href="#cb31-9"></a>      <span class="at">y =</span> cigarettes_total, </span>
<span id="cb31-10"><a href="#cb31-10"></a>      <span class="at">fill =</span> disease) <span class="sc">+</span></span>
<span id="cb31-11"><a href="#cb31-11"></a>  <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="output_figs/unnamed-chunk-16-1.png" width="768"></p>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="co"># with factor levels changed</span></span>
<span id="cb32-2"><a href="#cb32-2"></a><span class="fu">ggplot</span>(smoke_new) <span class="sc">+</span></span>
<span id="cb32-3"><a href="#cb32-3"></a>  <span class="fu">aes</span>(<span class="at">x =</span> disease_fac, </span>
<span id="cb32-4"><a href="#cb32-4"></a>      <span class="at">y =</span> cigarettes_total, </span>
<span id="cb32-5"><a href="#cb32-5"></a>      <span class="at">fill =</span> disease_fac) <span class="sc">+</span></span>
<span id="cb32-6"><a href="#cb32-6"></a>  <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="output_figs/unnamed-chunk-16-2.png" width="768"></p>
</div>
</div>
</div>
</div>
</div>
</section></section>
<section>
<section id="replace_na" class="title-slide slide level1 center" data-number="4">
<h1><span class="header-section-number">4</span> <code>replace_na</code></h1>
<ul>
<li>Replace missing values: use <code>mutate</code> with <code>replace_na</code></li>
</ul>
</section>
<section id="replace-missing-values-use-mutate-with-replace_na" class="slide level2" data-number="4.1">
<h2><span class="header-section-number">4.1</span> Replace missing values: use <code>mutate</code> with <code>replace_na</code></h2>
<ul>
<li>Sometimes we want to fill in missing values with a certain value.</li>
<li>Use the <code>replace_na()</code> function inside of <code>mutate()</code> to specify this.</li>
</ul>
<p><br></p>
<h3 data-number="4.1.1" id="example"><span class="header-section-number">4.1.1</span> Example</h3>
<ul>
<li>For example, if the days to last follow up is missing, we want to set their days to follow up to 0.
<ul>
<li>The first two observations in these data have missing follow up, but when we replace them we note they are now equal to 0:</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="fu">summary</span>(smoke_new<span class="sc">$</span>days_to_last_follow_up)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
  -64.0   296.0   641.0   944.9  1224.0  6375.0     271 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a>smoke_new <span class="sc">%&gt;%</span> <span class="fu">select</span>(days_to_last_follow_up) <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 1
  days_to_last_follow_up
                   &lt;dbl&gt;
1                     NA
2                     NA
3                   2099
4                   3747
5                   3576
6                     NA</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a>smoke_new <span class="ot">&lt;-</span> smoke_new <span class="sc">%&gt;%</span></span>
<span id="cb37-2"><a href="#cb37-2"></a>    <span class="fu">mutate</span>(</span>
<span id="cb37-3"><a href="#cb37-3"></a>      <span class="at">days_to_last_follow_up2 =</span> <span class="fu">replace_na</span>(days_to_last_follow_up, <span class="dv">0</span>)</span>
<span id="cb37-4"><a href="#cb37-4"></a>      )</span>
<span id="cb37-5"><a href="#cb37-5"></a></span>
<span id="cb37-6"><a href="#cb37-6"></a><span class="co"># only select these columns for printing, work has not been saved</span></span>
<span id="cb37-7"><a href="#cb37-7"></a>smoke_new <span class="sc">%&gt;%</span> </span>
<span id="cb37-8"><a href="#cb37-8"></a>  <span class="fu">select</span>(<span class="fu">contains</span>(<span class="st">"follow_up"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb37-9"><a href="#cb37-9"></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
  days_to_last_follow_up days_to_last_follow_up2
                   &lt;dbl&gt;                   &lt;dbl&gt;
1                     NA                       0
2                     NA                       0
3                   2099                    2099
4                   3747                    3747
5                   3576                    3576
6                     NA                       0</code></pre>
</div>
</div>
</section></section>
<section>
<section id="case_when" class="title-slide slide level1 center" data-number="5">
<h1><span class="header-section-number">5</span> <code>case_when()</code></h1>
<p>Create new variables based on multiple conditions</p>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="image/dplyr_case_when.png" style="width:75.0%"></p>
<figcaption><a href="https://allisonhorst.com/r-packages-functions">Image from Allison Horst</a></figcaption>
</figure>
</div>
</section>
<section id="use-case_when-within-mutate-to-make-a-continuous-variable-categorical" class="slide level2" data-number="5.1">
<h2><span class="header-section-number">5.1</span> Use <code>case_when()</code> within <code>mutate</code> to make a continuous variable categorical</h2>
<ul>
<li>Say we want to make the <code>cigarettes_per_day</code> into a categorical variable with the values:
<ul>
<li>0-5 cigarettes/day</li>
<li>6+ cigarettes/day</li>
</ul></li>
<li>How would we do that?
<ul>
<li>We saw one way to create a binary variable,
<ul>
<li>i.e.&nbsp;<code>1*(cigarettes_per_day &gt;= 6)</code>,</li>
</ul></li>
<li>but here we want to use <code>case_when()</code>,
<ul>
<li>which, as you will see, is much more flexible.</li>
</ul></li>
</ul></li>
</ul>
<p><br></p>
<p>With <code>case_when()</code>, we need to follow this basic pattern for each of our categories:</p>
<blockquote>
<p>condition ~ category name</p>
</blockquote>
<ul>
<li>The <em>left</em> side of the <code>~</code> is where we define the <em>category</em> based on our column variable names.</li>
<li>The <em>right</em> side of the <code>~</code> is where we specify the <em>category name</em> (as a character).</li>
</ul>
<p><br></p>
<ul>
<li>In the example below,
<ul>
<li><code>cigarettes_per_day &lt; 6</code> is our left side, and</li>
<li><code>0-5</code> is our right side (our category name).</li>
</ul></li>
<li>We need to do this for each level in our category.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="co"># note this work is not saved, no assignment operator!</span></span>
<span id="cb39-2"><a href="#cb39-2"></a>smoke_new <span class="sc">%&gt;%</span></span>
<span id="cb39-3"><a href="#cb39-3"></a>  <span class="co"># case_when() is used *inside* mutate()</span></span>
<span id="cb39-4"><a href="#cb39-4"></a>  <span class="fu">mutate</span>(</span>
<span id="cb39-5"><a href="#cb39-5"></a>    <span class="at">cigarettes_category =</span> <span class="fu">case_when</span>(        <span class="co"># new column name to left of =</span></span>
<span id="cb39-6"><a href="#cb39-6"></a>      <span class="co"># TRUE/FALSE statement to left of ~</span></span>
<span id="cb39-7"><a href="#cb39-7"></a>      cigarettes_per_day <span class="sc">&lt;</span> <span class="dv">6</span> <span class="sc">~</span> <span class="st">"0-5"</span>,       <span class="co"># don't forget a comma between cases</span></span>
<span id="cb39-8"><a href="#cb39-8"></a>      cigarettes_per_day <span class="sc">&gt;=</span> <span class="dv">6</span> <span class="sc">~</span> <span class="st">"6+"</span></span>
<span id="cb39-9"><a href="#cb39-9"></a>    )</span>
<span id="cb39-10"><a href="#cb39-10"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb39-11"><a href="#cb39-11"></a>  <span class="fu">mutate</span>(<span class="at">cigarettes_category =</span> <span class="fu">factor</span>(cigarettes_category)) <span class="sc">%&gt;%</span></span>
<span id="cb39-12"><a href="#cb39-12"></a>  <span class="fu">tabyl</span>(cigarettes_category)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> cigarettes_category    n    percent
                 0-5 1100 0.95486111
                  6+   52 0.04513889</code></pre>
</div>
</div>
</section>
<section id="mini-challenge-2-5-minutes" class="slide level2" data-number="5.2">
<h2><span class="header-section-number">5.2</span> Mini-challenge 2 (~5 minutes)</h2>
<ul>
<li>Modify the code below to recode <code>cigarettes_category</code> to have 3 levels:
<ul>
<li><code>0-2</code></li>
<li><code>3-5</code> (everything bigger than 2 and less than 6)</li>
<li><code>6+</code></li>
</ul></li>
</ul>
<p><em>Hint: you’ll have to chain conditions with an <code>&amp;</code> to get the <code>3-5</code> category.</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a>smoke_new <span class="sc">%&gt;%</span></span>
<span id="cb41-2"><a href="#cb41-2"></a>  <span class="fu">mutate</span>(</span>
<span id="cb41-3"><a href="#cb41-3"></a>    <span class="at">cigarettes_category =</span> <span class="fu">case_when</span>(</span>
<span id="cb41-4"><a href="#cb41-4"></a>      cigarettes_per_day <span class="sc">&lt;=</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">"0-2"</span>,</span>
<span id="cb41-5"><a href="#cb41-5"></a>      </span>
<span id="cb41-6"><a href="#cb41-6"></a>      <span class="sc">------</span> <span class="er">~</span> <span class="sc">------</span>, <span class="co"># fill this in</span></span>
<span id="cb41-7"><a href="#cb41-7"></a>      </span>
<span id="cb41-8"><a href="#cb41-8"></a>      cigarettes_per_day <span class="sc">&gt;=</span> <span class="dv">6</span> <span class="sc">~</span> <span class="st">"6+"</span></span>
<span id="cb41-9"><a href="#cb41-9"></a>    )</span>
<span id="cb41-10"><a href="#cb41-10"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb41-11"><a href="#cb41-11"></a>  <span class="fu">mutate</span>(<span class="at">cigarettes_category =</span> <span class="fu">factor</span>(cigarettes_category)) <span class="sc">%&gt;%</span></span>
<span id="cb41-12"><a href="#cb41-12"></a>  <span class="fu">tabyl</span>(cigarettes_category)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="case_when-with-character-vectors" class="slide level2" data-number="5.3">
<h2><span class="header-section-number">5.3</span> <code>case_when</code> with character vectors</h2>
<p>Goal: collapse the tumor stages stages into three categories: stage i, stage ii, and everything else.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a>smoke_new <span class="sc">%&gt;%</span> <span class="fu">tabyl</span>(tumor_stage)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  tumor_stage   n     percent
 not reported  99 0.085937500
      stage i   7 0.006076389
     stage ia 146 0.126736111
     stage ib 266 0.230902778
     stage ii  65 0.056423611
    stage iia 112 0.097222222
    stage iib 148 0.128472222
    stage iii  86 0.074652778
   stage iiia 102 0.088541667
   stage iiib  30 0.026041667
     stage iv  91 0.078993056</code></pre>
</div>
</div>
<div class="panel-tabset">
<ul id="tabset-3" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-3-1">Comments</a></li><li><a href="#tabset-3-2">Version 1</a></li><li><a href="#tabset-3-3">Version 2</a></li><li><a href="#tabset-3-4">Version 3</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1">
<p>Some important points in this example:</p>
<ul>
<li>We could use many “|” statements (“or” statements),
<ul>
<li>or we could define multiple cases for the same category.</li>
</ul></li>
<li>This works because of how <code>case_when</code> works:
<ul>
<li>if THIS, then category.</li>
<li>else if THIS, then category.</li>
<li>else if THIS, then category…</li>
<li>and on and on</li>
</ul></li>
<li>The <code>.default</code> at the end is the value assigned when all other conditions return <code>FALSE</code> or <code>NA</code>,
<ul>
<li>i.e.&nbsp;“else default to this”.</li>
<li>If left blank or not specified then a missing value will be used.</li>
</ul></li>
</ul>
</div>
<div id="tabset-3-2">
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a>smoke_new <span class="ot">&lt;-</span> smoke_new <span class="sc">%&gt;%</span></span>
<span id="cb44-2"><a href="#cb44-2"></a>  <span class="fu">mutate</span>(</span>
<span id="cb44-3"><a href="#cb44-3"></a>    <span class="co"># new column name = case_when()</span></span>
<span id="cb44-4"><a href="#cb44-4"></a>    <span class="at">stage_category =</span> <span class="fu">case_when</span>(</span>
<span id="cb44-5"><a href="#cb44-5"></a>      <span class="co"># group these tumor stages together as "i"</span></span>
<span id="cb44-6"><a href="#cb44-6"></a>      tumor_stage <span class="sc">==</span> <span class="st">"stage i"</span> <span class="sc">~</span> <span class="st">"i"</span>,</span>
<span id="cb44-7"><a href="#cb44-7"></a>      tumor_stage <span class="sc">==</span> <span class="st">"stage ia"</span> <span class="sc">~</span> <span class="st">"i"</span>,</span>
<span id="cb44-8"><a href="#cb44-8"></a>      tumor_stage <span class="sc">==</span> <span class="st">"stage ib"</span> <span class="sc">~</span> <span class="st">"i"</span>,</span>
<span id="cb44-9"><a href="#cb44-9"></a>      <span class="co"># group these together as "ii"</span></span>
<span id="cb44-10"><a href="#cb44-10"></a>      tumor_stage <span class="sc">==</span> <span class="st">"stage ii"</span> <span class="sc">~</span> <span class="st">"ii"</span>,</span>
<span id="cb44-11"><a href="#cb44-11"></a>      tumor_stage <span class="sc">==</span> <span class="st">"stage iia"</span> <span class="sc">~</span> <span class="st">"ii"</span>,</span>
<span id="cb44-12"><a href="#cb44-12"></a>      tumor_stage <span class="sc">==</span> <span class="st">"stage iib"</span> <span class="sc">~</span> <span class="st">"ii"</span>,</span>
<span id="cb44-13"><a href="#cb44-13"></a>      <span class="co"># else if, then categorize as "other"</span></span>
<span id="cb44-14"><a href="#cb44-14"></a>      <span class="at">.default =</span> <span class="st">"other"</span></span>
<span id="cb44-15"><a href="#cb44-15"></a>    )</span>
<span id="cb44-16"><a href="#cb44-16"></a>    )</span>
<span id="cb44-17"><a href="#cb44-17"></a></span>
<span id="cb44-18"><a href="#cb44-18"></a>smoke_new <span class="sc">%&gt;%</span> <span class="fu">tabyl</span>(tumor_stage, stage_category)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  tumor_stage   i  ii other
 not reported   0   0    99
      stage i   7   0     0
     stage ia 146   0     0
     stage ib 266   0     0
     stage ii   0  65     0
    stage iia   0 112     0
    stage iib   0 148     0
    stage iii   0   0    86
   stage iiia   0   0   102
   stage iiib   0   0    30
     stage iv   0   0    91</code></pre>
</div>
</div>
</div>
<div id="tabset-3-3">
<p>Using <code>|</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a>smoke_new <span class="ot">&lt;-</span> smoke_new <span class="sc">%&gt;%</span></span>
<span id="cb46-2"><a href="#cb46-2"></a>  <span class="fu">mutate</span>(</span>
<span id="cb46-3"><a href="#cb46-3"></a>    <span class="co"># new column name = case_when()</span></span>
<span id="cb46-4"><a href="#cb46-4"></a>    <span class="at">stage_category =</span> <span class="fu">case_when</span>(</span>
<span id="cb46-5"><a href="#cb46-5"></a>      <span class="co"># group these tumor stages together as "i"</span></span>
<span id="cb46-6"><a href="#cb46-6"></a>      tumor_stage <span class="sc">==</span> <span class="st">"stage i"</span> <span class="sc">|</span> </span>
<span id="cb46-7"><a href="#cb46-7"></a>        tumor_stage <span class="sc">==</span> <span class="st">"stage ia"</span> <span class="sc">|</span> </span>
<span id="cb46-8"><a href="#cb46-8"></a>        tumor_stage <span class="sc">==</span> <span class="st">"stage ib"</span> <span class="sc">~</span> <span class="st">"i"</span>,</span>
<span id="cb46-9"><a href="#cb46-9"></a>      <span class="co"># group these together as "ii"</span></span>
<span id="cb46-10"><a href="#cb46-10"></a>      tumor_stage <span class="sc">==</span> <span class="st">"stage ii"</span> <span class="sc">|</span></span>
<span id="cb46-11"><a href="#cb46-11"></a>        tumor_stage <span class="sc">==</span> <span class="st">"stage iia"</span> <span class="sc">|</span></span>
<span id="cb46-12"><a href="#cb46-12"></a>        tumor_stage <span class="sc">==</span> <span class="st">"stage iib"</span> <span class="sc">~</span> <span class="st">"ii"</span>,</span>
<span id="cb46-13"><a href="#cb46-13"></a>      <span class="co"># else if, then categorize as "other"</span></span>
<span id="cb46-14"><a href="#cb46-14"></a>      <span class="at">.default =</span> <span class="st">"other"</span></span>
<span id="cb46-15"><a href="#cb46-15"></a>    )</span>
<span id="cb46-16"><a href="#cb46-16"></a>    )</span>
<span id="cb46-17"><a href="#cb46-17"></a></span>
<span id="cb46-18"><a href="#cb46-18"></a>smoke_new <span class="sc">%&gt;%</span> <span class="fu">tabyl</span>(tumor_stage, stage_category)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  tumor_stage   i  ii other
 not reported   0   0    99
      stage i   7   0     0
     stage ia 146   0     0
     stage ib 266   0     0
     stage ii   0  65     0
    stage iia   0 112     0
    stage iib   0 148     0
    stage iii   0   0    86
   stage iiia   0   0   102
   stage iiib   0   0    30
     stage iv   0   0    91</code></pre>
</div>
</div>
</div>
<div id="tabset-3-4">
<p>Using <code>%in%</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a>smoke_new <span class="ot">&lt;-</span> smoke_new <span class="sc">%&gt;%</span></span>
<span id="cb48-2"><a href="#cb48-2"></a>  <span class="fu">mutate</span>(</span>
<span id="cb48-3"><a href="#cb48-3"></a>    <span class="co"># new column name = case_when()</span></span>
<span id="cb48-4"><a href="#cb48-4"></a>    <span class="at">stage_category =</span> <span class="fu">case_when</span>(</span>
<span id="cb48-5"><a href="#cb48-5"></a>      <span class="co"># group these tumor stages together as "i"</span></span>
<span id="cb48-6"><a href="#cb48-6"></a>      tumor_stage <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"stage i"</span>, <span class="st">"stage ia"</span>, <span class="st">"stage ib"</span>) <span class="sc">~</span> <span class="st">"i"</span>,</span>
<span id="cb48-7"><a href="#cb48-7"></a>      <span class="co"># group these together as "ii"</span></span>
<span id="cb48-8"><a href="#cb48-8"></a>      tumor_stage <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"stage ii"</span>, <span class="st">"stage iia"</span>, <span class="st">"stage iib"</span>) <span class="sc">~</span> <span class="st">"ii"</span>,</span>
<span id="cb48-9"><a href="#cb48-9"></a>      <span class="co"># else if, then categorize as "other"</span></span>
<span id="cb48-10"><a href="#cb48-10"></a>      <span class="at">.default =</span> <span class="st">"other"</span></span>
<span id="cb48-11"><a href="#cb48-11"></a>    )</span>
<span id="cb48-12"><a href="#cb48-12"></a>    )</span>
<span id="cb48-13"><a href="#cb48-13"></a></span>
<span id="cb48-14"><a href="#cb48-14"></a>smoke_new <span class="sc">%&gt;%</span> <span class="fu">tabyl</span>(tumor_stage, stage_category)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  tumor_stage   i  ii other
 not reported   0   0    99
      stage i   7   0     0
     stage ia 146   0     0
     stage ib 266   0     0
     stage ii   0  65     0
    stage iia   0 112     0
    stage iib   0 148     0
    stage iii   0   0    86
   stage iiia   0   0   102
   stage iiib   0   0    30
     stage iv   0   0    91</code></pre>
</div>
</div>
</div>
</div>
</div>
</section></section>
<section>
<section id="mutate-across-multiple-columns-with-across" class="title-slide slide level1 center" data-number="6">
<h1><span class="header-section-number">6</span> <code>mutate()</code> across multiple columns with <code>across()</code></h1>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="image/dplyr_across.png" style="width:65.0%"></p>
<figcaption><a href="https://allisonhorst.com/r-packages-functions">Image from Allison Horst</a></figcaption>
</figure>
</div>
</section>
<section id="mutate-across-multiple-columns-with-across-1" class="slide level2" data-number="6.1">
<h2><span class="header-section-number">6.1</span> <code>mutate()</code> across multiple columns with <code>across()</code></h2>
<ul>
<li>Often we may want to mutate multiple variables in the same way.</li>
<li>One option is to follow the examples above and specify each operation individually.</li>
</ul>
<p><br></p>
<ul>
<li>For example, suppose we want to convert the values of come character columns into “title case”.
<ul>
<li>There’s a function in the <code>stringr</code> package that does this:</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a>myvec <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"people"</span>, <span class="st">"thing"</span>)</span>
<span id="cb50-2"><a href="#cb50-2"></a>stringr<span class="sc">::</span><span class="fu">str_to_title</span>(myvec)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "People" "Thing" </code></pre>
</div>
</div>
<ul>
<li>We can apply this to multiple columns one at a time:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a>smoke_complete <span class="sc">%&gt;%</span></span>
<span id="cb52-2"><a href="#cb52-2"></a>    <span class="fu">mutate</span>(<span class="at">tumor_stage =</span> <span class="fu">str_to_title</span>(tumor_stage),</span>
<span id="cb52-3"><a href="#cb52-3"></a>           <span class="at">vital_status =</span> <span class="fu">str_to_title</span>(vital_status),</span>
<span id="cb52-4"><a href="#cb52-4"></a>           <span class="at">gender =</span> <span class="fu">str_to_title</span>(gender),</span>
<span id="cb52-5"><a href="#cb52-5"></a>           <span class="at">race =</span> <span class="fu">str_to_title</span>(race)) <span class="sc">%&gt;%</span></span>
<span id="cb52-6"><a href="#cb52-6"></a>  <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,152
Columns: 20
$ primary_diagnosis           &lt;chr&gt; "C34.1", "C34.1", "C34.3", "C34.1", "C34.1…
$ tumor_stage                 &lt;chr&gt; "Stage Ia", "Stage Ib", "Stage Ib", "Stage…
$ age_at_diagnosis            &lt;dbl&gt; 24477, 26615, 28171, 27154, 23370, 19025, …
$ vital_status                &lt;chr&gt; "Dead", "Dead", "Dead", "Alive", "Alive", …
$ morphology                  &lt;chr&gt; "8070/3", "8070/3", "8070/3", "8083/3", "8…
$ days_to_death               &lt;dbl&gt; 371, 136, 2304, NA, NA, 345, 716, 2803, 97…
$ state                       &lt;chr&gt; "live", "live", "live", "live", "live", "l…
$ tissue_or_organ_of_origin   &lt;chr&gt; "C34.1", "C34.1", "C34.3", "C34.1", "C34.1…
$ days_to_birth               &lt;dbl&gt; -24477, -26615, -28171, -27154, -23370, -1…
$ site_of_resection_or_biopsy &lt;chr&gt; "C34.1", "C34.1", "C34.3", "C34.1", "C34.1…
$ days_to_last_follow_up      &lt;dbl&gt; NA, NA, 2099, 3747, 3576, NA, NA, 1810, 95…
$ cigarettes_per_day          &lt;dbl&gt; 10.9589041, 2.1917808, 1.6438356, 1.095890…
$ years_smoked                &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, 26, NA…
$ gender                      &lt;chr&gt; "Male", "Male", "Female", "Male", "Female"…
$ year_of_birth               &lt;dbl&gt; 1936, 1931, 1927, 1930, 1942, 1953, 1932, …
$ race                        &lt;chr&gt; "White", "Asian", "White", "White", "Not R…
$ ethnicity                   &lt;chr&gt; "not hispanic or latino", "not hispanic or…
$ year_of_death               &lt;dbl&gt; 2004, 2003, NA, NA, NA, 2005, 2006, NA, NA…
$ bcr_patient_barcode         &lt;chr&gt; "TCGA-18-3406", "TCGA-18-3407", "TCGA-18-3…
$ disease                     &lt;chr&gt; "LUSC", "LUSC", "LUSC", "LUSC", "LUSC", "L…</code></pre>
</div>
</div>
<ul>
<li>Phew, that’s a lot of typing! But we can use <code>across()</code> to automate this.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a>smoke_complete <span class="sc">%&gt;%</span></span>
<span id="cb54-2"><a href="#cb54-2"></a>    <span class="fu">mutate</span>(</span>
<span id="cb54-3"><a href="#cb54-3"></a>      <span class="fu">across</span>(<span class="at">.cols =</span> <span class="fu">c</span>(tumor_stage, vital_status, gender, race),</span>
<span id="cb54-4"><a href="#cb54-4"></a>             <span class="at">.fns =</span> str_to_title)</span>
<span id="cb54-5"><a href="#cb54-5"></a>      ) <span class="sc">%&gt;%</span></span>
<span id="cb54-6"><a href="#cb54-6"></a>  <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,152
Columns: 20
$ primary_diagnosis           &lt;chr&gt; "C34.1", "C34.1", "C34.3", "C34.1", "C34.1…
$ tumor_stage                 &lt;chr&gt; "Stage Ia", "Stage Ib", "Stage Ib", "Stage…
$ age_at_diagnosis            &lt;dbl&gt; 24477, 26615, 28171, 27154, 23370, 19025, …
$ vital_status                &lt;chr&gt; "Dead", "Dead", "Dead", "Alive", "Alive", …
$ morphology                  &lt;chr&gt; "8070/3", "8070/3", "8070/3", "8083/3", "8…
$ days_to_death               &lt;dbl&gt; 371, 136, 2304, NA, NA, 345, 716, 2803, 97…
$ state                       &lt;chr&gt; "live", "live", "live", "live", "live", "l…
$ tissue_or_organ_of_origin   &lt;chr&gt; "C34.1", "C34.1", "C34.3", "C34.1", "C34.1…
$ days_to_birth               &lt;dbl&gt; -24477, -26615, -28171, -27154, -23370, -1…
$ site_of_resection_or_biopsy &lt;chr&gt; "C34.1", "C34.1", "C34.3", "C34.1", "C34.1…
$ days_to_last_follow_up      &lt;dbl&gt; NA, NA, 2099, 3747, 3576, NA, NA, 1810, 95…
$ cigarettes_per_day          &lt;dbl&gt; 10.9589041, 2.1917808, 1.6438356, 1.095890…
$ years_smoked                &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, 26, NA…
$ gender                      &lt;chr&gt; "Male", "Male", "Female", "Male", "Female"…
$ year_of_birth               &lt;dbl&gt; 1936, 1931, 1927, 1930, 1942, 1953, 1932, …
$ race                        &lt;chr&gt; "White", "Asian", "White", "White", "Not R…
$ ethnicity                   &lt;chr&gt; "not hispanic or latino", "not hispanic or…
$ year_of_death               &lt;dbl&gt; 2004, 2003, NA, NA, NA, 2005, 2006, NA, NA…
$ bcr_patient_barcode         &lt;chr&gt; "TCGA-18-3406", "TCGA-18-3407", "TCGA-18-3…
$ disease                     &lt;chr&gt; "LUSC", "LUSC", "LUSC", "LUSC", "LUSC", "L…</code></pre>
</div>
</div>
</section>
<section id="how-do-we-use-across" class="slide level2" data-number="6.2">
<h2><span class="header-section-number">6.2</span> How do we use <code>across()</code>?</h2>
<ul>
<li>The above example uses the <code>across()</code> function <em>inside</em> <code>mutate()</code> function.
<ul>
<li>Note that <code>mutate()</code> wraps fully around <code>across()</code> so it’s a nested function call on the data:</li>
</ul></li>
</ul>
<blockquote>
<p>data %&gt;% mutate(across(____))</p>
</blockquote>
<ul>
<li>This is an advanced way of using <code>mutate()</code> and also <code>summarize()</code>, as we will see later today.</li>
</ul>
<p><br></p>
<ul>
<li><code>across()</code> has two important arguments
<ul>
<li><code>.cols</code> selects the columns you want to operate on.
<ul>
<li>It uses tidyselect (like <code>select()</code>), so you can pick variables by position, name, and type</li>
</ul></li>
<li><code>.fns</code> is the function or <em>list</em> of functions to apply to each column.
<ul>
<li>This can also be a purrr style formula (or list of formulas) like <code>~ .x/2</code>.
<ul>
<li>This will take some practice. We will see this again when we go over <code>purrr</code> in later classes.</li>
</ul></li>
</ul></li>
</ul></li>
</ul>
<p><br></p>
<ul>
<li>Some useful readings on this topic are:
<ul>
<li><a href="https://dplyr.tidyverse.org/reference/across.html">across help page</a></li>
<li><a href="https://dplyr.tidyverse.org/articles/colwise.html">column-wise operations vignette</a> (from which the above was taken from)</li>
<li><a href="https://willhipson.netlify.app/post/dplyr_across/dplyr_across/">why I love across</a> - Will Hipson, PhD</li>
</ul></li>
</ul>
</section>
<section id="across-examples" class="slide level2" data-number="6.3">
<h2><span class="header-section-number">6.3</span> <code>across()</code> examples</h2>
<ul>
<li>Suppose we want to convert all the days variables to years.</li>
</ul>
<div class="panel-tabset">
<ul id="tabset-4" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-4-1">Brute force</a></li><li><a href="#tabset-4-2"><code>across()</code> take 1</a></li><li><a href="#tabset-4-3">take 2</a></li><li><a href="#tabset-4-4">take 3</a></li><li><a href="#tabset-4-5">take 4</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1">
<ul>
<li>One column at a time looks like this:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a>smoke_complete <span class="sc">%&gt;%</span></span>
<span id="cb56-2"><a href="#cb56-2"></a>    <span class="fu">mutate</span>(</span>
<span id="cb56-3"><a href="#cb56-3"></a>      <span class="at">years_to_death =</span> days_to_death<span class="sc">/</span><span class="dv">365</span>,</span>
<span id="cb56-4"><a href="#cb56-4"></a>      <span class="at">years_to_birth =</span> days_to_birth<span class="sc">/</span><span class="dv">365</span>,</span>
<span id="cb56-5"><a href="#cb56-5"></a>      <span class="at">years_to_last_follow_up =</span> days_to_last_follow_up<span class="sc">/</span><span class="dv">365</span></span>
<span id="cb56-6"><a href="#cb56-6"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb56-7"><a href="#cb56-7"></a>  <span class="co"># check</span></span>
<span id="cb56-8"><a href="#cb56-8"></a>  <span class="fu">select</span>(<span class="fu">contains</span>(<span class="st">"_to_"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,152 × 6
   days_to_death days_to_birth days_to_last_follow_up years_to_death
           &lt;dbl&gt;         &lt;dbl&gt;                  &lt;dbl&gt;          &lt;dbl&gt;
 1           371        -24477                     NA          1.02 
 2           136        -26615                     NA          0.373
 3          2304        -28171                   2099          6.31 
 4            NA        -27154                   3747         NA    
 5            NA        -23370                   3576         NA    
 6           345        -19025                     NA          0.945
 7           716        -26938                     NA          1.96 
 8          2803        -28430                   1810          7.68 
 9           973        -30435                    956          2.67 
10          1097        -24019                    758          3.01 
# ℹ 1,142 more rows
# ℹ 2 more variables: years_to_birth &lt;dbl&gt;, years_to_last_follow_up &lt;dbl&gt;</code></pre>
</div>
</div>
</div>
<div id="tabset-4-2">
<ul>
<li>Below is the <code>across()</code> automated way,
<ul>
<li>using our own math/operation a.k.a “function”.</li>
</ul></li>
<li><code>across()</code>
<ul>
<li>first asks which variables to use (<code>.cols =</code>)</li>
<li>then asks which operation(s) (<code>.fns =</code>).</li>
</ul></li>
<li>Below we create our own function <code>~ .x/365</code>
<ul>
<li>We need the <code>~</code> when we define our own operation or function.
<ul>
<li>This tells R, <em>function starts here!</em></li>
</ul></li>
<li>The <code>.x</code> is a placeholder for the column(s) input,
<ul>
<li>think of it as algebra with the math operation: <code>column/365</code>.</li>
</ul></li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a>smoke_complete <span class="sc">%&gt;%</span></span>
<span id="cb58-2"><a href="#cb58-2"></a>    <span class="fu">mutate</span>(</span>
<span id="cb58-3"><a href="#cb58-3"></a>        <span class="fu">across</span>(<span class="at">.cols =</span> <span class="fu">c</span>(days_to_death, </span>
<span id="cb58-4"><a href="#cb58-4"></a>                         days_to_birth, </span>
<span id="cb58-5"><a href="#cb58-5"></a>                         days_to_last_follow_up), </span>
<span id="cb58-6"><a href="#cb58-6"></a>               <span class="at">.fns =</span> <span class="sc">~</span> .x<span class="sc">/</span><span class="dv">365</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb58-7"><a href="#cb58-7"></a>  <span class="co"># check</span></span>
<span id="cb58-8"><a href="#cb58-8"></a>  <span class="fu">select</span>(<span class="fu">contains</span>(<span class="st">"_to_"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,152 × 3
   days_to_death days_to_birth days_to_last_follow_up
           &lt;dbl&gt;         &lt;dbl&gt;                  &lt;dbl&gt;
 1         1.02          -67.1                  NA   
 2         0.373         -72.9                  NA   
 3         6.31          -77.2                   5.75
 4        NA             -74.4                  10.3 
 5        NA             -64.0                   9.80
 6         0.945         -52.1                  NA   
 7         1.96          -73.8                  NA   
 8         7.68          -77.9                   4.96
 9         2.67          -83.4                   2.62
10         3.01          -65.8                   2.08
# ℹ 1,142 more rows</code></pre>
</div>
</div>
</div>
<div id="tabset-4-3">
<ul>
<li>In take 1, we mutated the variables “in place”,
<ul>
<li>that is, we rewrote our data with the mutated data in “years”</li>
<li>but did not change the names!</li>
</ul></li>
<li>This can be confusing.</li>
<li>There are different ways to fix this.</li>
<li>Right now, we will use a simple method,
<ul>
<li>with the <code>rename</code> function,</li>
<li>which renames our columns (essentially a wrapper of <code>mutate()</code>).</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a>smoke_days <span class="ot">&lt;-</span> smoke_complete <span class="sc">%&gt;%</span></span>
<span id="cb60-2"><a href="#cb60-2"></a>    <span class="fu">mutate</span>(</span>
<span id="cb60-3"><a href="#cb60-3"></a>        <span class="fu">across</span>(<span class="at">.cols =</span> <span class="fu">c</span>(days_to_death, days_to_birth, days_to_last_follow_up), </span>
<span id="cb60-4"><a href="#cb60-4"></a>               <span class="at">.fns =</span> <span class="sc">~</span> .x<span class="sc">/</span><span class="dv">365</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb60-5"><a href="#cb60-5"></a>  <span class="fu">rename</span>(</span>
<span id="cb60-6"><a href="#cb60-6"></a>    <span class="at">years_to_death =</span> days_to_death,</span>
<span id="cb60-7"><a href="#cb60-7"></a>    <span class="at">years_to_birth =</span> days_to_birth,</span>
<span id="cb60-8"><a href="#cb60-8"></a>    <span class="at">years_to_last_follow_up =</span> days_to_last_follow_up</span>
<span id="cb60-9"><a href="#cb60-9"></a>  ) </span>
<span id="cb60-10"><a href="#cb60-10"></a><span class="co"># check</span></span>
<span id="cb60-11"><a href="#cb60-11"></a>smoke_days <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">contains</span>(<span class="st">"_to_"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,152 × 3
   years_to_death years_to_birth years_to_last_follow_up
            &lt;dbl&gt;          &lt;dbl&gt;                   &lt;dbl&gt;
 1          1.02           -67.1                   NA   
 2          0.373          -72.9                   NA   
 3          6.31           -77.2                    5.75
 4         NA              -74.4                   10.3 
 5         NA              -64.0                    9.80
 6          0.945          -52.1                   NA   
 7          1.96           -73.8                   NA   
 8          7.68           -77.9                    4.96
 9          2.67           -83.4                    2.62
10          3.01           -65.8                    2.08
# ℹ 1,142 more rows</code></pre>
</div>
</div>
</div>
<div id="tabset-4-4">
<ul>
<li>As an advanced preview, once we learn about
<ul>
<li><code>glue</code> to manipulate strings, and</li>
<li><code>stringr</code> package functions such as <code>str_replace</code></li>
</ul></li>
<li>we can change the names using the <code>.names=</code> argument inside <code>across()</code> with these methods:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a>smoke_days <span class="ot">&lt;-</span> smoke_complete <span class="sc">%&gt;%</span></span>
<span id="cb62-2"><a href="#cb62-2"></a>    <span class="fu">mutate</span>(</span>
<span id="cb62-3"><a href="#cb62-3"></a>        <span class="fu">across</span>(<span class="at">.cols =</span> <span class="fu">c</span>(days_to_death, days_to_birth, days_to_last_follow_up), </span>
<span id="cb62-4"><a href="#cb62-4"></a>               <span class="at">.fns =</span> <span class="sc">~</span> .x<span class="sc">/</span><span class="dv">365</span>,</span>
<span id="cb62-5"><a href="#cb62-5"></a>               <span class="at">.names =</span> <span class="st">"{str_replace(.col, 'years','days')}"</span>)) </span>
<span id="cb62-6"><a href="#cb62-6"></a></span>
<span id="cb62-7"><a href="#cb62-7"></a>smoke_days <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">contains</span>(<span class="st">"_to_"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,152 × 3
   days_to_death days_to_birth days_to_last_follow_up
           &lt;dbl&gt;         &lt;dbl&gt;                  &lt;dbl&gt;
 1         1.02          -67.1                  NA   
 2         0.373         -72.9                  NA   
 3         6.31          -77.2                   5.75
 4        NA             -74.4                  10.3 
 5        NA             -64.0                   9.80
 6         0.945         -52.1                  NA   
 7         1.96          -73.8                  NA   
 8         7.68          -77.9                   4.96
 9         2.67          -83.4                   2.62
10         3.01          -65.8                   2.08
# ℹ 1,142 more rows</code></pre>
</div>
</div>
</div>
<div id="tabset-4-5">
<ul>
<li>What if we had many, many “days_to” columns?
<ul>
<li>That still is a lot of typing…</li>
</ul></li>
<li>We can actually use <code>across()</code> in a more powerful with <code>tidyselect</code>.</li>
</ul>
<p>First, remember how we can use <code>select()</code> with the <code>tidyselect</code> syntax, such as:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a>smoke_complete <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"days"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,152 × 3
   days_to_death days_to_birth days_to_last_follow_up
           &lt;dbl&gt;         &lt;dbl&gt;                  &lt;dbl&gt;
 1           371        -24477                     NA
 2           136        -26615                     NA
 3          2304        -28171                   2099
 4            NA        -27154                   3747
 5            NA        -23370                   3576
 6           345        -19025                     NA
 7           716        -26938                     NA
 8          2803        -28430                   1810
 9           973        -30435                    956
10          1097        -24019                    758
# ℹ 1,142 more rows</code></pre>
</div>
</div>
<p><em>See more examples <a href="https://dplyr.tidyverse.org/reference/select.html">here</a>.</em></p>
<ul>
<li>We can use <code>tidyselect</code> to choose our variables within <code>across()</code>,
<ul>
<li>for instance, we could call the same variables by using <code>starts_with("days")</code>.</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a>smoke_days <span class="ot">&lt;-</span> smoke_complete <span class="sc">%&gt;%</span></span>
<span id="cb66-2"><a href="#cb66-2"></a>    <span class="fu">mutate</span>(</span>
<span id="cb66-3"><a href="#cb66-3"></a>        <span class="fu">across</span>(<span class="at">.cols =</span> <span class="fu">starts_with</span>(<span class="st">"days"</span>), <span class="co"># now we are using tidyselect here</span></span>
<span id="cb66-4"><a href="#cb66-4"></a>               <span class="at">.fns =</span> <span class="sc">~</span> .x<span class="sc">/</span><span class="dv">365</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb66-5"><a href="#cb66-5"></a>  <span class="fu">rename</span>(</span>
<span id="cb66-6"><a href="#cb66-6"></a>    <span class="at">years_to_death =</span> days_to_death,</span>
<span id="cb66-7"><a href="#cb66-7"></a>    <span class="at">years_to_birth =</span> days_to_birth,</span>
<span id="cb66-8"><a href="#cb66-8"></a>    <span class="at">years_to_last_follow_up =</span> days_to_last_follow_up</span>
<span id="cb66-9"><a href="#cb66-9"></a>  ) </span>
<span id="cb66-10"><a href="#cb66-10"></a></span>
<span id="cb66-11"><a href="#cb66-11"></a>smoke_days <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">contains</span>(<span class="st">"_to_"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,152 × 3
   years_to_death years_to_birth years_to_last_follow_up
            &lt;dbl&gt;          &lt;dbl&gt;                   &lt;dbl&gt;
 1          1.02           -67.1                   NA   
 2          0.373          -72.9                   NA   
 3          6.31           -77.2                    5.75
 4         NA              -74.4                   10.3 
 5         NA              -64.0                    9.80
 6          0.945          -52.1                   NA   
 7          1.96           -73.8                   NA   
 8          7.68           -77.9                    4.96
 9          2.67           -83.4                    2.62
10          3.01           -65.8                    2.08
# ℹ 1,142 more rows</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="using-across-takes-some-getting-used" class="slide level2" data-number="6.4">
<h2><span class="header-section-number">6.4</span> Using <code>across()</code> takes some getting used</h2>
<ul>
<li>Using <code>across()</code> takes some getting used to,
<ul>
<li>but seeing more examples will help you see how it works.</li>
</ul></li>
<li>There are also more complex ways to use your own functions and naming conventions.</li>
</ul>
<p><br></p>
<ul>
<li>Look at this vignette for many examples: <a href="https://dplyr.tidyverse.org/articles/colwise.html">dplyr colwise vignette</a>.</li>
</ul>
</section>
<section id="using-built-in-function-with-across" class="slide level2" data-number="6.5">
<h2><span class="header-section-number">6.5</span> Using built-in function with <code>across()</code></h2>
<ul>
<li>We can also use built in function names (instead of <code>~.x/365</code> for example)</li>
</ul>
<div class="panel-tabset">
<ul id="tabset-5" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-5-1"><code>replace_na()</code></a></li><li><a href="#tabset-5-2"><code>str_to_title()</code></a></li><li><a href="#tabset-5-3"><code>as.factor()</code></a></li></ul>
<div class="tab-content">
<div id="tabset-5-1">
<p>Replace all missing numeric values with 0</p>
<ul>
<li>Below we
<ul>
<li>select the numeric columns using <code>where(is.numeric)</code>
<ul>
<li>(<code>where()</code> is a tidyselect function that selects those for which the function returns <code>TRUE</code>), and</li>
</ul></li>
<li>replace missing values with 0
<ul>
<li>(<code>replace =</code> is an argument of <code>replace_na()</code>).</li>
</ul></li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a>smoke_complete <span class="sc">%&gt;%</span></span>
<span id="cb68-2"><a href="#cb68-2"></a>  <span class="fu">mutate</span>(</span>
<span id="cb68-3"><a href="#cb68-3"></a>    <span class="co"># replace is an argument of replace_na</span></span>
<span id="cb68-4"><a href="#cb68-4"></a>    <span class="fu">across</span>(<span class="at">.cols =</span> <span class="fu">where</span>(is.numeric), </span>
<span id="cb68-5"><a href="#cb68-5"></a>           <span class="at">.fns =</span> <span class="sc">~</span> <span class="fu">replace_na</span>(.x, <span class="at">replace =</span> <span class="dv">0</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb68-6"><a href="#cb68-6"></a>  <span class="co"># check</span></span>
<span id="cb68-7"><a href="#cb68-7"></a>  <span class="fu">select</span>(<span class="fu">where</span>(is.numeric)) <span class="sc">%&gt;%</span> </span>
<span id="cb68-8"><a href="#cb68-8"></a>  <span class="fu">summary</span>()   <span class="co"># note no NAs!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> age_at_diagnosis days_to_death    days_to_birth    days_to_last_follow_up
 Min.   : 7855    Min.   :   0.0   Min.   :-32872   Min.   : -64.0        
 1st Qu.:22069    1st Qu.:   0.0   1st Qu.:-26927   1st Qu.:   7.5        
 Median :24750    Median :   0.0   Median :-24750   Median : 441.0        
 Mean   :24175    Mean   : 371.5   Mean   :-24175   Mean   : 722.6        
 3rd Qu.:26927    3rd Qu.: 461.8   3rd Qu.:-22069   3rd Qu.: 987.0        
 Max.   :32872    Max.   :5287.0   Max.   : -7855   Max.   :6375.0        
 cigarettes_per_day  years_smoked   year_of_birth  year_of_death   
 Min.   : 0.00822   Min.   : 0.00   Min.   :   0   Min.   :   0.0  
 1st Qu.: 1.36986   1st Qu.: 0.00   1st Qu.:1933   1st Qu.:   0.0  
 Median : 2.19178   Median : 0.00   Median :1940   Median :   0.0  
 Mean   : 2.60800   Mean   :14.56   Mean   :1883   Mean   : 616.6  
 3rd Qu.: 3.28767   3rd Qu.:35.00   3rd Qu.:1949   3rd Qu.:2004.0  
 Max.   :40.00000   Max.   :63.00   Max.   :1986   Max.   :2013.0  </code></pre>
</div>
</div>
</div>
<div id="tabset-5-2">
<p>Convert all character columns to title case</p>
<ul>
<li>Use the <code>where()</code> function to select all columns that are a character type<br>
</li>
<li><code>is.character()</code> returns
<ul>
<li><code>TRUE</code> if the column is a character type, and</li>
<li><code>FALSE</code> otherwise</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1"></a>smoke_complete <span class="sc">%&gt;%</span></span>
<span id="cb70-2"><a href="#cb70-2"></a>    <span class="fu">mutate</span>(</span>
<span id="cb70-3"><a href="#cb70-3"></a>      <span class="fu">across</span>(<span class="at">.cols =</span> <span class="fu">where</span>(is.character),</span>
<span id="cb70-4"><a href="#cb70-4"></a>             <span class="at">.fns =</span> str_to_title)  <span class="co"># note no ~ and .x</span></span>
<span id="cb70-5"><a href="#cb70-5"></a>      ) <span class="sc">%&gt;%</span></span>
<span id="cb70-6"><a href="#cb70-6"></a>  <span class="co"># check</span></span>
<span id="cb70-7"><a href="#cb70-7"></a>  <span class="fu">select</span>(<span class="fu">where</span>(is.character)) <span class="sc">%&gt;%</span> </span>
<span id="cb70-8"><a href="#cb70-8"></a>  <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,152
Columns: 12
$ primary_diagnosis           &lt;chr&gt; "C34.1", "C34.1", "C34.3", "C34.1", "C34.1…
$ tumor_stage                 &lt;chr&gt; "Stage Ia", "Stage Ib", "Stage Ib", "Stage…
$ vital_status                &lt;chr&gt; "Dead", "Dead", "Dead", "Alive", "Alive", …
$ morphology                  &lt;chr&gt; "8070/3", "8070/3", "8070/3", "8083/3", "8…
$ state                       &lt;chr&gt; "Live", "Live", "Live", "Live", "Live", "L…
$ tissue_or_organ_of_origin   &lt;chr&gt; "C34.1", "C34.1", "C34.3", "C34.1", "C34.1…
$ site_of_resection_or_biopsy &lt;chr&gt; "C34.1", "C34.1", "C34.3", "C34.1", "C34.1…
$ gender                      &lt;chr&gt; "Male", "Male", "Female", "Male", "Female"…
$ race                        &lt;chr&gt; "White", "Asian", "White", "White", "Not R…
$ ethnicity                   &lt;chr&gt; "Not Hispanic Or Latino", "Not Hispanic Or…
$ bcr_patient_barcode         &lt;chr&gt; "Tcga-18-3406", "Tcga-18-3407", "Tcga-18-3…
$ disease                     &lt;chr&gt; "Lusc", "Lusc", "Lusc", "Lusc", "Lusc", "L…</code></pre>
</div>
</div>
<ul>
<li>In the above example, I didn’t need to specify any arguments for the <code>str_to_title()</code> function.</li>
<li>Thus I was able to simplify the <code>.fns</code> part of the code with just <code>.fns = str_to_title</code></li>
<li>The long (<code>purrr</code>) way works as well
<ul>
<li><strong>If you use the <code>~</code>, you have to add the <code>(.x)</code></strong></li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1"></a>smoke_complete <span class="sc">%&gt;%</span></span>
<span id="cb72-2"><a href="#cb72-2"></a>    <span class="fu">mutate</span>(</span>
<span id="cb72-3"><a href="#cb72-3"></a>      <span class="fu">across</span>(<span class="at">.cols =</span> <span class="fu">where</span>(is.character),</span>
<span id="cb72-4"><a href="#cb72-4"></a>             <span class="at">.fns =</span> <span class="sc">~</span> <span class="fu">str_to_title</span>(.x))  <span class="co"># with ~ and .x</span></span>
<span id="cb72-5"><a href="#cb72-5"></a>      ) <span class="sc">%&gt;%</span></span>
<span id="cb72-6"><a href="#cb72-6"></a>  <span class="co"># check</span></span>
<span id="cb72-7"><a href="#cb72-7"></a>  <span class="fu">select</span>(<span class="fu">where</span>(is.character)) <span class="sc">%&gt;%</span> </span>
<span id="cb72-8"><a href="#cb72-8"></a>  <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,152
Columns: 12
$ primary_diagnosis           &lt;chr&gt; "C34.1", "C34.1", "C34.3", "C34.1", "C34.1…
$ tumor_stage                 &lt;chr&gt; "Stage Ia", "Stage Ib", "Stage Ib", "Stage…
$ vital_status                &lt;chr&gt; "Dead", "Dead", "Dead", "Alive", "Alive", …
$ morphology                  &lt;chr&gt; "8070/3", "8070/3", "8070/3", "8083/3", "8…
$ state                       &lt;chr&gt; "Live", "Live", "Live", "Live", "Live", "L…
$ tissue_or_organ_of_origin   &lt;chr&gt; "C34.1", "C34.1", "C34.3", "C34.1", "C34.1…
$ site_of_resection_or_biopsy &lt;chr&gt; "C34.1", "C34.1", "C34.3", "C34.1", "C34.1…
$ gender                      &lt;chr&gt; "Male", "Male", "Female", "Male", "Female"…
$ race                        &lt;chr&gt; "White", "Asian", "White", "White", "Not R…
$ ethnicity                   &lt;chr&gt; "Not Hispanic Or Latino", "Not Hispanic Or…
$ bcr_patient_barcode         &lt;chr&gt; "Tcga-18-3406", "Tcga-18-3407", "Tcga-18-3…
$ disease                     &lt;chr&gt; "Lusc", "Lusc", "Lusc", "Lusc", "Lusc", "L…</code></pre>
</div>
</div>
</div>
<div id="tabset-5-3">
<p>Convert all character columns to factors</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1"></a>smoke_complete <span class="sc">%&gt;%</span></span>
<span id="cb74-2"><a href="#cb74-2"></a>    <span class="fu">mutate</span>(</span>
<span id="cb74-3"><a href="#cb74-3"></a>      <span class="fu">across</span>(<span class="at">.cols =</span> <span class="fu">where</span>(is.character), </span>
<span id="cb74-4"><a href="#cb74-4"></a>             <span class="at">.fns =</span> as.factor)) <span class="sc">%&gt;%</span>   <span class="co"># factor works as well</span></span>
<span id="cb74-5"><a href="#cb74-5"></a>  <span class="co"># check  </span></span>
<span id="cb74-6"><a href="#cb74-6"></a>  <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,152
Columns: 20
$ primary_diagnosis           &lt;fct&gt; C34.1, C34.1, C34.3, C34.1, C34.1, C34.3, …
$ tumor_stage                 &lt;fct&gt; stage ia, stage ib, stage ib, stage ia, st…
$ age_at_diagnosis            &lt;dbl&gt; 24477, 26615, 28171, 27154, 23370, 19025, …
$ vital_status                &lt;fct&gt; dead, dead, dead, alive, alive, dead, dead…
$ morphology                  &lt;fct&gt; 8070/3, 8070/3, 8070/3, 8083/3, 8070/3, 80…
$ days_to_death               &lt;dbl&gt; 371, 136, 2304, NA, NA, 345, 716, 2803, 97…
$ state                       &lt;fct&gt; live, live, live, live, live, live, live, …
$ tissue_or_organ_of_origin   &lt;fct&gt; C34.1, C34.1, C34.3, C34.1, C34.1, C34.3, …
$ days_to_birth               &lt;dbl&gt; -24477, -26615, -28171, -27154, -23370, -1…
$ site_of_resection_or_biopsy &lt;fct&gt; C34.1, C34.1, C34.3, C34.1, C34.1, C34.3, …
$ days_to_last_follow_up      &lt;dbl&gt; NA, NA, 2099, 3747, 3576, NA, NA, 1810, 95…
$ cigarettes_per_day          &lt;dbl&gt; 10.9589041, 2.1917808, 1.6438356, 1.095890…
$ years_smoked                &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, 26, NA…
$ gender                      &lt;fct&gt; male, male, female, male, female, male, ma…
$ year_of_birth               &lt;dbl&gt; 1936, 1931, 1927, 1930, 1942, 1953, 1932, …
$ race                        &lt;fct&gt; white, asian, white, white, not reported, …
$ ethnicity                   &lt;fct&gt; not hispanic or latino, not hispanic or la…
$ year_of_death               &lt;dbl&gt; 2004, 2003, NA, NA, NA, 2005, 2006, NA, NA…
$ bcr_patient_barcode         &lt;fct&gt; TCGA-18-3406, TCGA-18-3407, TCGA-18-3408, …
$ disease                     &lt;fct&gt; LUSC, LUSC, LUSC, LUSC, LUSC, LUSC, LUSC, …</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="challenge-2-10-minutes" class="slide level2" data-number="6.6">
<h2><span class="header-section-number">6.6</span> Challenge 2 (~10 minutes)</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1"></a><span class="fu">data</span>(penguins) <span class="co"># from the palmerpenguins package</span></span>
<span id="cb76-2"><a href="#cb76-2"></a><span class="fu">glimpse</span>(penguins)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 344
Columns: 8
$ species           &lt;fct&gt; Adelie, Adelie, Adelie, Adelie, Adelie, Adelie, Adel…
$ island            &lt;fct&gt; Torgersen, Torgersen, Torgersen, Torgersen, Torgerse…
$ bill_length_mm    &lt;dbl&gt; 39.1, 39.5, 40.3, NA, 36.7, 39.3, 38.9, 39.2, 34.1, …
$ bill_depth_mm     &lt;dbl&gt; 18.7, 17.4, 18.0, NA, 19.3, 20.6, 17.8, 19.6, 18.1, …
$ flipper_length_mm &lt;int&gt; 181, 186, 195, NA, 193, 190, 181, 195, 193, 190, 186…
$ body_mass_g       &lt;int&gt; 3750, 3800, 3250, NA, 3450, 3650, 3625, 4675, 3475, …
$ sex               &lt;fct&gt; male, female, female, NA, female, male, female, male…
$ year              &lt;int&gt; 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007…</code></pre>
</div>
</div>
<ol type="1">
<li>Convert all variables in the <code>palmerpenguins</code> data set that end with <code>mm</code> to <code>cm</code> by dividing by 10</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1"></a>penguins <span class="sc">%&gt;%</span></span>
<span id="cb78-2"><a href="#cb78-2"></a>    <span class="fu">mutate</span>(</span>
<span id="cb78-3"><a href="#cb78-3"></a>        <span class="fu">across</span>(<span class="at">.cols =</span> <span class="sc">----</span>, </span>
<span id="cb78-4"><a href="#cb78-4"></a>               <span class="at">.fns =</span> <span class="sc">~</span> <span class="sc">-----</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb78-5"><a href="#cb78-5"></a>    <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="2" type="1">
<li>Convert all factor variables to numeric:</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1"></a>penguins <span class="sc">%&gt;%</span></span>
<span id="cb79-2"><a href="#cb79-2"></a>  <span class="fu">mutate</span>(</span>
<span id="cb79-3"><a href="#cb79-3"></a>    <span class="fu">across</span>(<span class="at">.cols =</span> <span class="sc">----</span>, </span>
<span id="cb79-4"><a href="#cb79-4"></a>           <span class="at">.fns =</span> <span class="sc">~</span> <span class="sc">-----</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb79-5"><a href="#cb79-5"></a>  <span class="er">)</span> <span class="sc">%&gt;%</span></span>
<span id="cb79-6"><a href="#cb79-6"></a>  <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="3" type="1">
<li>Convert all factor vectors to character, then convert their values to all caps:</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1"></a>penguins <span class="sc">%&gt;%</span></span>
<span id="cb80-2"><a href="#cb80-2"></a>  <span class="fu">mutate</span>(</span>
<span id="cb80-3"><a href="#cb80-3"></a>    </span>
<span id="cb80-4"><a href="#cb80-4"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section>
<section>
<section id="summarize-data" class="title-slide slide level1 center" data-number="7">
<h1><span class="header-section-number">7</span> <code>summarize()</code> data</h1>
<p>The <code>summarize()</code> verb produces (surprise!) summaries of your data, and outputs a tibble with this information.</p>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="image/summarize-1.png" style="width:100.0%"></p>
<figcaption><a href="https://datasciencebook.ca/wrangling.html#aggregating-data-with-summarize-and-map">Image source: Data Science Book</a></figcaption>
</figure>
</div>
</section>
<section id="basic-summarize-example" class="slide level2" data-number="7.1">
<h2><span class="header-section-number">7.1</span> Basic <code>summarize()</code> example</h2>
<ul>
<li>Find the average (mean) <code>days_to_last_follow_up</code>:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1"></a>smoke_new <span class="sc">%&gt;%</span></span>
<span id="cb81-2"><a href="#cb81-2"></a>  <span class="fu">summarize</span>(<span class="at">days_to_last_follow_up =</span> <span class="fu">mean</span>(days_to_last_follow_up))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  days_to_last_follow_up
                   &lt;dbl&gt;
1                     NA</code></pre>
</div>
</div>
<ul>
<li>I forgot an important argument to my mean function!</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1"></a>smoke_new <span class="sc">%&gt;%</span></span>
<span id="cb83-2"><a href="#cb83-2"></a>    <span class="fu">summarize</span>(<span class="at">days_to_last_follow_up =</span> </span>
<span id="cb83-3"><a href="#cb83-3"></a>                <span class="fu">mean</span>(days_to_last_follow_up, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  days_to_last_follow_up
                   &lt;dbl&gt;
1                   945.</code></pre>
</div>
</div>
<ul>
<li>Compare to the base R way:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1"></a><span class="fu">mean</span>(smoke_new<span class="sc">$</span>days_to_last_follow_up, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 944.8547</code></pre>
</div>
</div>
</section>
<section id="what-are-the-kinds-of-things-that-summarize-is-useful-for" class="slide level2" data-number="7.2">
<h2><span class="header-section-number">7.2</span> What are the kinds of things that summarize is useful for?</h2>
<p>Useful functions (from <a href="https://dplyr.tidyverse.org/reference/summarise.html" class="uri">https://dplyr.tidyverse.org/reference/summarise.html</a>)</p>
<ul>
<li>Center: <code>mean()</code>, <code>median()</code></li>
<li>Spread: <code>sd()</code> (standard deviation)</li>
<li>Range: <code>min()</code>, <code>max()</code></li>
<li>Position: <code>first()</code>, <code>last()</code>, <code>nth()</code></li>
<li>Count: <code>n()</code>, <code>n_distinct()</code></li>
<li>Percentiles: <code>quantile()</code></li>
</ul>
<p>By itself, <code>summarize()</code> is nice. But it’s really when combined with <code>group_by()</code> that it becomes extremely powerful.</p>
</section>
<section id="group_by-and-summarize" class="slide level2" data-number="7.3">
<h2><span class="header-section-number">7.3</span> <code>group_by()</code> and <code>summarize()</code></h2>
<ul>
<li>These two verbs must go together.
<ul>
<li><code>group_by()</code> doesn’t do anything by itself, output wise.</li>
</ul></li>
<li>What <code>group_by()</code> does is split our dataset
<ul>
<li>into a number of smaller datasets split out by category</li>
<li>(shown as different colors in figure below)</li>
</ul></li>
<li>Then we use <code>summarize</code> to do a summary calculation (such as counting or calculating the mean) on the smaller datasets</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="image/summarize-groupby-1.png" style="width:100.0%"></p>
<figcaption><a href="https://datasciencebook.ca/wrangling.html#calculating-summary-statistics-for-groups-of-rows">Image source: Data Science Book</a></figcaption>
</figure>
</div>
</section>
<section id="example-group_by-and-summarize" class="slide level2" data-number="7.4">
<h2><span class="header-section-number">7.4</span> Example: <code>group_by()</code> and <code>summarize()</code></h2>
<ul>
<li>For example, if we want to compare the mean <code>age_at_diagnosis</code> for each disease type, we’d do the following:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1"></a>smoke_new <span class="sc">%&gt;%</span></span>
<span id="cb87-2"><a href="#cb87-2"></a>  <span class="fu">group_by</span>(disease) <span class="sc">%&gt;%</span></span>
<span id="cb87-3"><a href="#cb87-3"></a>  <span class="fu">summarize</span>(<span class="at">average_age =</span> <span class="fu">mean</span>(age_at_diagnosis, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  disease average_age
  &lt;chr&gt;         &lt;dbl&gt;
1 BLCA         24931.
2 CESC         16973.
3 LUSC         24765.</code></pre>
</div>
</div>
<ul>
<li>When we <code>group_by()</code> a variable, it changes an attribute/property of our data, which we can see in <code>glimpse()</code>:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1"></a>smoke_new <span class="sc">%&gt;%</span></span>
<span id="cb89-2"><a href="#cb89-2"></a>  <span class="fu">group_by</span>(disease) <span class="sc">%&gt;%</span></span>
<span id="cb89-3"><a href="#cb89-3"></a>  <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,152
Columns: 27
Groups: disease [3]
$ primary_diagnosis           &lt;chr&gt; "C34.1", "C34.1", "C34.3", "C34.1", "C34.1…
$ tumor_stage                 &lt;chr&gt; "stage ia", "stage ib", "stage ib", "stage…
$ age_at_diagnosis            &lt;dbl&gt; 24477, 26615, 28171, 27154, 23370, 19025, …
$ vital_status                &lt;fct&gt; dead, dead, dead, alive, alive, dead, dead…
$ morphology                  &lt;chr&gt; "8070/3", "8070/3", "8070/3", "8083/3", "8…
$ days_to_death               &lt;dbl&gt; 371, 136, 2304, NA, NA, 345, 716, 2803, 97…
$ state                       &lt;chr&gt; "live", "live", "live", "live", "live", "l…
$ tissue_or_organ_of_origin   &lt;chr&gt; "C34.1", "C34.1", "C34.3", "C34.1", "C34.1…
$ days_to_birth               &lt;dbl&gt; -24477, -26615, -28171, -27154, -23370, -1…
$ site_of_resection_or_biopsy &lt;chr&gt; "C34.1", "C34.1", "C34.3", "C34.1", "C34.1…
$ days_to_last_follow_up      &lt;dbl&gt; NA, NA, 2099, 3747, 3576, NA, NA, 1810, 95…
$ cigarettes_per_day          &lt;dbl&gt; 10.9589041, 2.1917808, 1.6438356, 1.095890…
$ years_smoked                &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, 26, NA…
$ gender                      &lt;fct&gt; male, male, female, male, female, male, ma…
$ year_of_birth               &lt;dbl&gt; 1936, 1931, 1927, 1930, 1942, 1953, 1932, …
$ race                        &lt;chr&gt; "white", "asian", "white", "white", "not r…
$ ethnicity                   &lt;chr&gt; "not hispanic or latino", "not hispanic or…
$ year_of_death               &lt;dbl&gt; 2004, 2003, NA, NA, NA, 2005, 2006, NA, NA…
$ bcr_patient_barcode         &lt;chr&gt; "TCGA-18-3406", "TCGA-18-3407", "TCGA-18-3…
$ disease                     &lt;chr&gt; "LUSC", "LUSC", "LUSC", "LUSC", "LUSC", "L…
$ alive                       &lt;lgl&gt; FALSE, FALSE, FALSE, TRUE, TRUE, FALSE, FA…
$ alive2                      &lt;dbl&gt; 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 1, 1, 0, 0, …
$ cigarettes_total            &lt;dbl&gt; 268241.10, 58334.25, 46308.49, 29757.81, 6…
$ cigarettes_high             &lt;dbl&gt; 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, …
$ disease_fac                 &lt;fct&gt; LUSC, LUSC, LUSC, LUSC, LUSC, LUSC, LUSC, …
$ days_to_last_follow_up2     &lt;dbl&gt; 0, 0, 2099, 3747, 3576, 0, 0, 1810, 956, 7…
$ stage_category              &lt;chr&gt; "i", "i", "i", "i", "other", "i", "other",…</code></pre>
</div>
</div>
</section>
<section id="example-calculate-means-and-standard-deviations-with-group_by-and-summarize" class="slide level2" data-number="7.5">
<h2><span class="header-section-number">7.5</span> Example: calculate means and standard deviations with <code>group_by()</code> and <code>summarize()</code></h2>
<ul>
<li>We can have multiple summaries within one <code>summarize()</code> function.</li>
<li>Calculate both the mean age at diagnosis and the standard deviation, for each disease type.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1"></a>smoke_new <span class="sc">%&gt;%</span></span>
<span id="cb91-2"><a href="#cb91-2"></a>  <span class="fu">group_by</span>(disease) <span class="sc">%&gt;%</span></span>
<span id="cb91-3"><a href="#cb91-3"></a>  <span class="fu">summarize</span>(<span class="at">mean_age =</span> <span class="fu">mean</span>(age_at_diagnosis, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb91-4"><a href="#cb91-4"></a>            <span class="at">sd_age =</span> <span class="fu">sd</span>(age_at_diagnosis, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  disease mean_age sd_age
  &lt;chr&gt;      &lt;dbl&gt;  &lt;dbl&gt;
1 BLCA      24931.  3571.
2 CESC      16973.  4717.
3 LUSC      24765.  3033.</code></pre>
</div>
</div>
</section>
<section id="group_by-multiple-variables-and-summarize" class="slide level2" data-number="7.6">
<h2><span class="header-section-number">7.6</span> <code>group_by</code> multiple variables and <code>summarize()</code></h2>
<ul>
<li>Calculate
<ul>
<li>both the mean age at diagnosis and the standard deviation,</li>
<li>for each disease type and gender</li>
</ul></li>
<li>Add <code>gender</code> as a grouping variable:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1"></a>smoke_new <span class="sc">%&gt;%</span></span>
<span id="cb93-2"><a href="#cb93-2"></a>  <span class="fu">group_by</span>(disease, gender) <span class="sc">%&gt;%</span></span>
<span id="cb93-3"><a href="#cb93-3"></a>  <span class="fu">summarize</span>(<span class="at">mean_age =</span> <span class="fu">mean</span>(age_at_diagnosis, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb93-4"><a href="#cb93-4"></a>            <span class="at">sd_age =</span> <span class="fu">sd</span>(age_at_diagnosis, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 4
# Groups:   disease [3]
  disease gender mean_age sd_age
  &lt;chr&gt;   &lt;fct&gt;     &lt;dbl&gt;  &lt;dbl&gt;
1 BLCA    female   24873.  3821.
2 BLCA    male     24950.  3499.
3 CESC    female   16973.  4717.
4 LUSC    female   24900.  3117.
5 LUSC    male     24717.  3004.</code></pre>
</div>
</div>
</section>
<section id="count-frequencies-with-group_by" class="slide level2" data-number="7.7">
<h2><span class="header-section-number">7.7</span> <code>count()</code> frequencies with <code>group_by()</code></h2>
<ul>
<li>What if we want to know the number of people in our dataset within each <code>disease</code> and <code>gender</code> combination?</li>
<li>We can use the <code>n()</code> function.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1"></a>smoke_new <span class="sc">%&gt;%</span></span>
<span id="cb95-2"><a href="#cb95-2"></a>  <span class="fu">group_by</span>(disease, gender) <span class="sc">%&gt;%</span></span>
<span id="cb95-3"><a href="#cb95-3"></a>    <span class="fu">summarize</span>(<span class="at">count =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
# Groups:   disease [3]
  disease gender count
  &lt;chr&gt;   &lt;fct&gt;  &lt;int&gt;
1 BLCA    female    54
2 BLCA    male     170
3 CESC    female    92
4 LUSC    female   220
5 LUSC    male     616</code></pre>
</div>
</div>
<ul>
<li>We can also use the <code>count()</code> function directly.</li>
<li>However, knowing <code>n()</code> is a useful summarization to add to a bunch of summarizing functions in one <code>summarize()</code> statement.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1"></a>smoke_new <span class="sc">%&gt;%</span></span>
<span id="cb97-2"><a href="#cb97-2"></a>    <span class="fu">count</span>(disease, gender)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  disease gender     n
  &lt;chr&gt;   &lt;fct&gt;  &lt;int&gt;
1 BLCA    female    54
2 BLCA    male     170
3 CESC    female    92
4 LUSC    female   220
5 LUSC    male     616</code></pre>
</div>
</div>
<ul>
<li>Note: we can also create a two-way table to get these frequenices.
<ul>
<li>However, it’s sometimes handy to have the counts in a tibble to use for something else (such as creating figures).</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1"></a>smoke_new <span class="sc">%&gt;%</span></span>
<span id="cb99-2"><a href="#cb99-2"></a>    <span class="fu">tabyl</span>(disease, gender)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> disease female male
    BLCA     54  170
    CESC     92    0
    LUSC    220  616</code></pre>
</div>
</div>
</section>
<section id="summarize-with-across" class="slide level2" data-number="7.8">
<h2><span class="header-section-number">7.8</span> <code>summarize()</code> with <code>across()</code></h2>
<ul>
<li>In the same way that we used <code>across()</code> to <code>mutate()</code> several columns,
<ul>
<li>we can use <code>across()</code> to summarize several columns.</li>
</ul></li>
<li>Calculate the mean of all the numeric variables.</li>
<li>Remember that when we use a named function like <code>mean()</code> in <code>across()</code>,
<ul>
<li>we have to use the <code>~function(.x, arguments)</code> syntax</li>
<li>like this example with <code>na.rm = TRUE</code>:</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1"></a>smoke_new <span class="sc">%&gt;%</span></span>
<span id="cb101-2"><a href="#cb101-2"></a>  <span class="fu">group_by</span>(disease) <span class="sc">%&gt;%</span></span>
<span id="cb101-3"><a href="#cb101-3"></a>  <span class="fu">summarize</span>(<span class="fu">across</span>(<span class="at">.cols =</span> <span class="fu">where</span>(is.numeric), </span>
<span id="cb101-4"><a href="#cb101-4"></a>                   <span class="at">.fns =</span> <span class="sc">~</span> <span class="fu">mean</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)  </span>
<span id="cb101-5"><a href="#cb101-5"></a>                   ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 13
  disease age_at_diagnosis days_to_death days_to_birth days_to_last_follow_up
  &lt;chr&gt;              &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;                  &lt;dbl&gt;
1 BLCA              24931.          576.       -24931.                   778.
2 CESC              16973.         1100.       -16973.                  1225.
3 LUSC              24765.          911.       -24765.                   957.
# ℹ 8 more variables: cigarettes_per_day &lt;dbl&gt;, years_smoked &lt;dbl&gt;,
#   year_of_birth &lt;dbl&gt;, year_of_death &lt;dbl&gt;, alive2 &lt;dbl&gt;,
#   cigarettes_total &lt;dbl&gt;, cigarettes_high &lt;dbl&gt;,
#   days_to_last_follow_up2 &lt;dbl&gt;</code></pre>
</div>
</div>
<ul>
<li>Count the number of distinct values for each character vector:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1"></a>smoke_new <span class="sc">%&gt;%</span></span>
<span id="cb103-2"><a href="#cb103-2"></a>  <span class="fu">group_by</span>(disease) <span class="sc">%&gt;%</span></span>
<span id="cb103-3"><a href="#cb103-3"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.character), </span>
<span id="cb103-4"><a href="#cb103-4"></a>                   n_distinct))   <span class="co"># no function arguments needed, so can use simple way</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 11
  disease primary_diagnosis tumor_stage morphology state tissue_or_organ_of_or…¹
  &lt;chr&gt;               &lt;int&gt;       &lt;int&gt;      &lt;int&gt; &lt;int&gt;                   &lt;int&gt;
1 BLCA                    7           5          2     1                       7
2 CESC                    3           1          9     1                       3
3 LUSC                    7          11          6     1                       6
# ℹ abbreviated name: ¹​tissue_or_organ_of_origin
# ℹ 5 more variables: site_of_resection_or_biopsy &lt;int&gt;, race &lt;int&gt;,
#   ethnicity &lt;int&gt;, bcr_patient_barcode &lt;int&gt;, stage_category &lt;int&gt;</code></pre>
</div>
</div>
<ul>
<li>Note that “.cols =” and “.fns =” can be omitted</li>
</ul>
</section>
<section id="side-note-about-gtgt" class="slide level2" data-number="7.9">
<h2><span class="header-section-number">7.9</span> Side note about <code>gt::gt()</code></h2>
<ul>
<li>The <code>gt</code> package can make our tables look much nicer in html output.</li>
<li>We will talk about customizing the <code>gt()</code> output later in the quarter,
<ul>
<li>but for now, the default output is pretty nice</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1"></a><span class="co"># before gt</span></span>
<span id="cb105-2"><a href="#cb105-2"></a>smoke_new <span class="sc">%&gt;%</span></span>
<span id="cb105-3"><a href="#cb105-3"></a>  <span class="fu">group_by</span>(disease) <span class="sc">%&gt;%</span></span>
<span id="cb105-4"><a href="#cb105-4"></a>  <span class="fu">summarize</span>(<span class="fu">across</span>(<span class="at">.cols =</span> <span class="fu">starts_with</span>(<span class="st">"day"</span>), </span>
<span id="cb105-5"><a href="#cb105-5"></a>                   <span class="at">.fns =</span> <span class="sc">~</span> <span class="fu">mean</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb105-6"><a href="#cb105-6"></a>                   ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  disease days_to_death days_to_birth days_to_last_follow_up
  &lt;chr&gt;           &lt;dbl&gt;         &lt;dbl&gt;                  &lt;dbl&gt;
1 BLCA             576.       -24931.                   778.
2 CESC            1100.       -16973.                  1225.
3 LUSC             911.       -24765.                   957.
# ℹ 1 more variable: days_to_last_follow_up2 &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1"></a><span class="co"># after gt</span></span>
<span id="cb107-2"><a href="#cb107-2"></a>smoke_new <span class="sc">%&gt;%</span></span>
<span id="cb107-3"><a href="#cb107-3"></a>  <span class="fu">group_by</span>(disease) <span class="sc">%&gt;%</span></span>
<span id="cb107-4"><a href="#cb107-4"></a>  <span class="fu">summarize</span>(<span class="fu">across</span>(<span class="at">.cols =</span> <span class="fu">starts_with</span>(<span class="st">"day"</span>), </span>
<span id="cb107-5"><a href="#cb107-5"></a>                   <span class="at">.fns =</span> <span class="sc">~</span> <span class="fu">mean</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb107-6"><a href="#cb107-6"></a>                   )) <span class="sc">%&gt;%</span></span>
<span id="cb107-7"><a href="#cb107-7"></a>  <span class="fu">gt</span>()               <span class="co"># makes the table look nice in html</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="ylxaxolwhs" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ylxaxolwhs table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ylxaxolwhs thead, #ylxaxolwhs tbody, #ylxaxolwhs tfoot, #ylxaxolwhs tr, #ylxaxolwhs td, #ylxaxolwhs th {
  border-style: none;
}

#ylxaxolwhs p {
  margin: 0;
  padding: 0;
}

#ylxaxolwhs .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ylxaxolwhs .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ylxaxolwhs .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ylxaxolwhs .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ylxaxolwhs .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ylxaxolwhs .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ylxaxolwhs .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ylxaxolwhs .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ylxaxolwhs .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ylxaxolwhs .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ylxaxolwhs .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ylxaxolwhs .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ylxaxolwhs .gt_spanner_row {
  border-bottom-style: hidden;
}

#ylxaxolwhs .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ylxaxolwhs .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ylxaxolwhs .gt_from_md > :first-child {
  margin-top: 0;
}

#ylxaxolwhs .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ylxaxolwhs .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ylxaxolwhs .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ylxaxolwhs .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ylxaxolwhs .gt_row_group_first td {
  border-top-width: 2px;
}

#ylxaxolwhs .gt_row_group_first th {
  border-top-width: 2px;
}

#ylxaxolwhs .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ylxaxolwhs .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ylxaxolwhs .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ylxaxolwhs .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ylxaxolwhs .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ylxaxolwhs .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ylxaxolwhs .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ylxaxolwhs .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ylxaxolwhs .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ylxaxolwhs .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ylxaxolwhs .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ylxaxolwhs .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ylxaxolwhs .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ylxaxolwhs .gt_left {
  text-align: left;
}

#ylxaxolwhs .gt_center {
  text-align: center;
}

#ylxaxolwhs .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ylxaxolwhs .gt_font_normal {
  font-weight: normal;
}

#ylxaxolwhs .gt_font_bold {
  font-weight: bold;
}

#ylxaxolwhs .gt_font_italic {
  font-style: italic;
}

#ylxaxolwhs .gt_super {
  font-size: 65%;
}

#ylxaxolwhs .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ylxaxolwhs .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ylxaxolwhs .gt_indent_1 {
  text-indent: 5px;
}

#ylxaxolwhs .gt_indent_2 {
  text-indent: 10px;
}

#ylxaxolwhs .gt_indent_3 {
  text-indent: 15px;
}

#ylxaxolwhs .gt_indent_4 {
  text-indent: 20px;
}

#ylxaxolwhs .gt_indent_5 {
  text-indent: 25px;
}

#ylxaxolwhs .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ylxaxolwhs div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="disease">disease</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="days_to_death">days_to_death</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="days_to_birth">days_to_birth</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="days_to_last_follow_up">days_to_last_follow_up</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="days_to_last_follow_up2">days_to_last_follow_up2</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="disease" class="gt_row gt_left">BLCA</td>
<td headers="days_to_death" class="gt_row gt_right">575.7059</td>
<td headers="days_to_birth" class="gt_row gt_right">-24931.12</td>
<td headers="days_to_last_follow_up" class="gt_row gt_right">778.0870</td>
<td headers="days_to_last_follow_up2" class="gt_row gt_right">559.2500</td></tr>
    <tr><td headers="disease" class="gt_row gt_left">CESC</td>
<td headers="days_to_death" class="gt_row gt_right">1099.5769</td>
<td headers="days_to_birth" class="gt_row gt_right">-16973.26</td>
<td headers="days_to_last_follow_up" class="gt_row gt_right">1225.3676</td>
<td headers="days_to_last_follow_up2" class="gt_row gt_right">905.7065</td></tr>
    <tr><td headers="disease" class="gt_row gt_left">LUSC</td>
<td headers="days_to_death" class="gt_row gt_right">910.8984</td>
<td headers="days_to_birth" class="gt_row gt_right">-24765.46</td>
<td headers="days_to_last_follow_up" class="gt_row gt_right">956.7791</td>
<td headers="days_to_last_follow_up2" class="gt_row gt_right">746.1962</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1"></a><span class="co"># note that the gt package got installed &amp; loaded in the setup code chunk</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="summarize-multiple-functions-at-one-time" class="slide level2" data-number="7.10">
<h2><span class="header-section-number">7.10</span> <code>summarize()</code> multiple functions at one time</h2>
<ul>
<li>We can summarize the same function across multiple columns,
<ul>
<li>but we can also summarize with multiple functions using <code>across</code>!</li>
</ul></li>
<li>Note that we specify a <code>list</code> of functions.
<ul>
<li>We will talk a lot more about <code>list</code>s in a couple weeks.</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1"></a>smoke_new <span class="sc">%&gt;%</span></span>
<span id="cb109-2"><a href="#cb109-2"></a>  <span class="fu">group_by</span>(disease) <span class="sc">%&gt;%</span></span>
<span id="cb109-3"><a href="#cb109-3"></a>  <span class="fu">summarize</span>(<span class="fu">across</span>(<span class="fu">c</span>(age_at_diagnosis, days_to_death),</span>
<span id="cb109-4"><a href="#cb109-4"></a>                   <span class="at">.fns =</span> <span class="fu">list</span>(</span>
<span id="cb109-5"><a href="#cb109-5"></a>                     <span class="at">min =</span> <span class="sc">~</span> <span class="fu">min</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb109-6"><a href="#cb109-6"></a>                     <span class="at">mean =</span> <span class="sc">~</span> <span class="fu">mean</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb109-7"><a href="#cb109-7"></a>                     <span class="at">max =</span> <span class="sc">~</span> <span class="fu">max</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb109-8"><a href="#cb109-8"></a>                   )) <span class="sc">%&gt;%</span></span>
<span id="cb109-9"><a href="#cb109-9"></a>  <span class="fu">gt</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="tcidomdfgt" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#tcidomdfgt table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#tcidomdfgt thead, #tcidomdfgt tbody, #tcidomdfgt tfoot, #tcidomdfgt tr, #tcidomdfgt td, #tcidomdfgt th {
  border-style: none;
}

#tcidomdfgt p {
  margin: 0;
  padding: 0;
}

#tcidomdfgt .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#tcidomdfgt .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#tcidomdfgt .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#tcidomdfgt .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#tcidomdfgt .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#tcidomdfgt .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tcidomdfgt .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#tcidomdfgt .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#tcidomdfgt .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#tcidomdfgt .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#tcidomdfgt .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#tcidomdfgt .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#tcidomdfgt .gt_spanner_row {
  border-bottom-style: hidden;
}

#tcidomdfgt .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#tcidomdfgt .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#tcidomdfgt .gt_from_md > :first-child {
  margin-top: 0;
}

#tcidomdfgt .gt_from_md > :last-child {
  margin-bottom: 0;
}

#tcidomdfgt .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#tcidomdfgt .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#tcidomdfgt .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#tcidomdfgt .gt_row_group_first td {
  border-top-width: 2px;
}

#tcidomdfgt .gt_row_group_first th {
  border-top-width: 2px;
}

#tcidomdfgt .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#tcidomdfgt .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#tcidomdfgt .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#tcidomdfgt .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tcidomdfgt .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#tcidomdfgt .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#tcidomdfgt .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#tcidomdfgt .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#tcidomdfgt .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tcidomdfgt .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#tcidomdfgt .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#tcidomdfgt .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#tcidomdfgt .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#tcidomdfgt .gt_left {
  text-align: left;
}

#tcidomdfgt .gt_center {
  text-align: center;
}

#tcidomdfgt .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#tcidomdfgt .gt_font_normal {
  font-weight: normal;
}

#tcidomdfgt .gt_font_bold {
  font-weight: bold;
}

#tcidomdfgt .gt_font_italic {
  font-style: italic;
}

#tcidomdfgt .gt_super {
  font-size: 65%;
}

#tcidomdfgt .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#tcidomdfgt .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#tcidomdfgt .gt_indent_1 {
  text-indent: 5px;
}

#tcidomdfgt .gt_indent_2 {
  text-indent: 10px;
}

#tcidomdfgt .gt_indent_3 {
  text-indent: 15px;
}

#tcidomdfgt .gt_indent_4 {
  text-indent: 20px;
}

#tcidomdfgt .gt_indent_5 {
  text-indent: 25px;
}

#tcidomdfgt .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#tcidomdfgt div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="disease">disease</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="age_at_diagnosis_min">age_at_diagnosis_min</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="age_at_diagnosis_mean">age_at_diagnosis_mean</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="age_at_diagnosis_max">age_at_diagnosis_max</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="days_to_death_min">days_to_death_min</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="days_to_death_mean">days_to_death_mean</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="days_to_death_max">days_to_death_max</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="disease" class="gt_row gt_left">BLCA</td>
<td headers="age_at_diagnosis_min" class="gt_row gt_right">13867</td>
<td headers="age_at_diagnosis_mean" class="gt_row gt_right">24931.12</td>
<td headers="age_at_diagnosis_max" class="gt_row gt_right">31755</td>
<td headers="days_to_death_min" class="gt_row gt_right">56</td>
<td headers="days_to_death_mean" class="gt_row gt_right">575.7059</td>
<td headers="days_to_death_max" class="gt_row gt_right">3183</td></tr>
    <tr><td headers="disease" class="gt_row gt_left">CESC</td>
<td headers="age_at_diagnosis_min" class="gt_row gt_right">7855</td>
<td headers="age_at_diagnosis_mean" class="gt_row gt_right">16973.26</td>
<td headers="age_at_diagnosis_max" class="gt_row gt_right">31258</td>
<td headers="days_to_death_min" class="gt_row gt_right">132</td>
<td headers="days_to_death_mean" class="gt_row gt_right">1099.5769</td>
<td headers="days_to_death_max" class="gt_row gt_right">4086</td></tr>
    <tr><td headers="disease" class="gt_row gt_left">LUSC</td>
<td headers="age_at_diagnosis_min" class="gt_row gt_right">14643</td>
<td headers="age_at_diagnosis_mean" class="gt_row gt_right">24765.46</td>
<td headers="age_at_diagnosis_max" class="gt_row gt_right">32872</td>
<td headers="days_to_death_min" class="gt_row gt_right">1</td>
<td headers="days_to_death_mean" class="gt_row gt_right">910.8984</td>
<td headers="days_to_death_max" class="gt_row gt_right">5287</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<ul>
<li>Remember, you can always filter out missing values.
<ul>
<li>Think about this, what population are you summarizing now?</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1"></a>smoke_new <span class="sc">%&gt;%</span></span>
<span id="cb110-2"><a href="#cb110-2"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(days_to_death)) <span class="sc">%&gt;%</span></span>
<span id="cb110-3"><a href="#cb110-3"></a>  <span class="fu">group_by</span>(disease) <span class="sc">%&gt;%</span></span>
<span id="cb110-4"><a href="#cb110-4"></a>  <span class="fu">summarize</span>(<span class="fu">across</span>(<span class="fu">c</span>(age_at_diagnosis, days_to_death),</span>
<span id="cb110-5"><a href="#cb110-5"></a>                   <span class="at">.fns =</span> <span class="fu">list</span>(</span>
<span id="cb110-6"><a href="#cb110-6"></a>                     <span class="at">min =</span> <span class="sc">~</span> <span class="fu">min</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb110-7"><a href="#cb110-7"></a>                     <span class="at">mean =</span> <span class="sc">~</span> <span class="fu">mean</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb110-8"><a href="#cb110-8"></a>                     <span class="at">max =</span> <span class="sc">~</span> <span class="fu">max</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb110-9"><a href="#cb110-9"></a>                   )) <span class="sc">%&gt;%</span></span>
<span id="cb110-10"><a href="#cb110-10"></a>  <span class="fu">gt</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="itgcfzdzux" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#itgcfzdzux table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#itgcfzdzux thead, #itgcfzdzux tbody, #itgcfzdzux tfoot, #itgcfzdzux tr, #itgcfzdzux td, #itgcfzdzux th {
  border-style: none;
}

#itgcfzdzux p {
  margin: 0;
  padding: 0;
}

#itgcfzdzux .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#itgcfzdzux .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#itgcfzdzux .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#itgcfzdzux .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#itgcfzdzux .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#itgcfzdzux .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#itgcfzdzux .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#itgcfzdzux .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#itgcfzdzux .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#itgcfzdzux .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#itgcfzdzux .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#itgcfzdzux .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#itgcfzdzux .gt_spanner_row {
  border-bottom-style: hidden;
}

#itgcfzdzux .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#itgcfzdzux .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#itgcfzdzux .gt_from_md > :first-child {
  margin-top: 0;
}

#itgcfzdzux .gt_from_md > :last-child {
  margin-bottom: 0;
}

#itgcfzdzux .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#itgcfzdzux .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#itgcfzdzux .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#itgcfzdzux .gt_row_group_first td {
  border-top-width: 2px;
}

#itgcfzdzux .gt_row_group_first th {
  border-top-width: 2px;
}

#itgcfzdzux .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#itgcfzdzux .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#itgcfzdzux .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#itgcfzdzux .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#itgcfzdzux .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#itgcfzdzux .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#itgcfzdzux .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#itgcfzdzux .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#itgcfzdzux .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#itgcfzdzux .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#itgcfzdzux .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#itgcfzdzux .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#itgcfzdzux .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#itgcfzdzux .gt_left {
  text-align: left;
}

#itgcfzdzux .gt_center {
  text-align: center;
}

#itgcfzdzux .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#itgcfzdzux .gt_font_normal {
  font-weight: normal;
}

#itgcfzdzux .gt_font_bold {
  font-weight: bold;
}

#itgcfzdzux .gt_font_italic {
  font-style: italic;
}

#itgcfzdzux .gt_super {
  font-size: 65%;
}

#itgcfzdzux .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#itgcfzdzux .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#itgcfzdzux .gt_indent_1 {
  text-indent: 5px;
}

#itgcfzdzux .gt_indent_2 {
  text-indent: 10px;
}

#itgcfzdzux .gt_indent_3 {
  text-indent: 15px;
}

#itgcfzdzux .gt_indent_4 {
  text-indent: 20px;
}

#itgcfzdzux .gt_indent_5 {
  text-indent: 25px;
}

#itgcfzdzux .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#itgcfzdzux div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="disease">disease</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="age_at_diagnosis_min">age_at_diagnosis_min</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="age_at_diagnosis_mean">age_at_diagnosis_mean</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="age_at_diagnosis_max">age_at_diagnosis_max</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="days_to_death_min">days_to_death_min</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="days_to_death_mean">days_to_death_mean</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="days_to_death_max">days_to_death_max</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="disease" class="gt_row gt_left">BLCA</td>
<td headers="age_at_diagnosis_min" class="gt_row gt_right">17501</td>
<td headers="age_at_diagnosis_mean" class="gt_row gt_right">25539.54</td>
<td headers="age_at_diagnosis_max" class="gt_row gt_right">31442</td>
<td headers="days_to_death_min" class="gt_row gt_right">56</td>
<td headers="days_to_death_mean" class="gt_row gt_right">575.7059</td>
<td headers="days_to_death_max" class="gt_row gt_right">3183</td></tr>
    <tr><td headers="disease" class="gt_row gt_left">CESC</td>
<td headers="age_at_diagnosis_min" class="gt_row gt_right">7855</td>
<td headers="age_at_diagnosis_mean" class="gt_row gt_right">17596.08</td>
<td headers="age_at_diagnosis_max" class="gt_row gt_right">28873</td>
<td headers="days_to_death_min" class="gt_row gt_right">132</td>
<td headers="days_to_death_mean" class="gt_row gt_right">1099.5769</td>
<td headers="days_to_death_max" class="gt_row gt_right">4086</td></tr>
    <tr><td headers="disease" class="gt_row gt_left">LUSC</td>
<td headers="age_at_diagnosis_min" class="gt_row gt_right">14643</td>
<td headers="age_at_diagnosis_mean" class="gt_row gt_right">25306.56</td>
<td headers="age_at_diagnosis_max" class="gt_row gt_right">32872</td>
<td headers="days_to_death_min" class="gt_row gt_right">1</td>
<td headers="days_to_death_mean" class="gt_row gt_right">910.8984</td>
<td headers="days_to_death_max" class="gt_row gt_right">5287</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</section>
<section id="challenge-3-10-minutes" class="slide level2" data-number="7.11">
<h2><span class="header-section-number">7.11</span> Challenge 3 (10 minutes)</h2>
<ol type="1">
<li><p>Use <code>group_by()</code> with <code>summarize()</code> to calculate the minimum, maximum, and mean cigarettes_per_day by disease and vital status. Try doing this with and without <code>across()</code>.</p></li>
<li><p>Use <code>across()</code> with <code>summarize()</code> to calculate the number of distinct values of all columns that contain the word “days”, within each group defined by <code>alive.</code></p></li>
<li><p>Create a boxplot of days to death with disease on the x axis, and both the y axis and fill mapped to <code>cigarettes_high</code>. (Careful: You may need to change cigarettes_high somehow for this to work!)</p></li>
</ol>
</section></section>
<section>
<section id="more-ggplot2-fun-optional-if-time" class="title-slide slide level1 center" data-number="8">
<h1><span class="header-section-number">8</span> More <code>ggplot2</code> fun (Optional, if time)</h1>

</section>
<section id="geoms-are-layers-on-your-plot" class="slide level2" data-number="8.1">
<h2><span class="header-section-number">8.1</span> <code>geom</code>s are layers on your plot</h2>
<ul>
<li>The really neat thing about <code>geom</code>s are that they can be layered onto your plot.
<ul>
<li>Below we’re layering another geom, <code>geom_violin()</code> on <code>geom_boxplot()</code>.</li>
</ul></li>
<li>We’re providing a couple of values to <code>geom_violin()</code>:
<ul>
<li><code>alpha</code>, which controls the transparency of the geom</li>
<li><code>width</code>, which controls the overall width of the violins.</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1"></a>our_boxplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(smoke_new) <span class="sc">+</span></span>
<span id="cb111-2"><a href="#cb111-2"></a>  <span class="fu">aes</span>(<span class="at">y =</span> cigarettes_per_day, </span>
<span id="cb111-3"><a href="#cb111-3"></a>      <span class="at">x =</span> disease, </span>
<span id="cb111-4"><a href="#cb111-4"></a>      <span class="at">fill =</span> disease) <span class="sc">+</span></span>
<span id="cb111-5"><a href="#cb111-5"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb111-6"><a href="#cb111-6"></a>  <span class="fu">geom_violin</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">width =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb111-7"><a href="#cb111-7"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">20</span>)      <span class="co"># change the y limits here to make it easier to see</span></span>
<span id="cb111-8"><a href="#cb111-8"></a></span>
<span id="cb111-9"><a href="#cb111-9"></a>our_boxplot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="output_figs/unnamed-chunk-56-1.png" width="768"></p>
</div>
</div>
</section>
<section id="scales" class="slide level2" data-number="8.2">
<h2><span class="header-section-number">8.2</span> Scales</h2>
<ul>
<li>In part 3 we learned how to change color and fill “scales” or palettes in ggplots.</li>
<li>There are many other types of scales.</li>
<li>Think of a scale as a layer added to a ggplot.</li>
</ul>
<p>Scales are added to a ggplot for multiple reasons:</p>
<ul>
<li>Change color palettes of continuous or discrete values</li>
<li>Map discrete values to particular colors (make “LUSC” = “blue”)</li>
<li>Transform numerical axes (such as change a plot to a log scale)</li>
<li>Change the breaks (tick values) in a plot</li>
<li>Format values in a scale (such as dollars: “$500”, “600”)</li>
</ul>
<p>All scale functions begin with <code>scale_</code> and are followed by the <code>aesthetic</code> it’s working on, and the <code>transformation</code> of the data.</p>
</section>
<section id="changing-axis-ticks-and-values-using-scale_x_continuous" class="slide level2" data-number="8.3">
<h2><span class="header-section-number">8.3</span> Changing axis ticks and values using <code>scale_x_continuous()</code></h2>
<p>One use for <code>scale_</code> functions is to modify the <em>breaks</em> (the tick values along an axis).</p>
<ul>
<li>Below we’re including the <code>scale_x_continuous()</code> argument called <code>breaks</code>,
<ul>
<li>which is a numeric vector that specifies the values we want each tick to be at:</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1"></a><span class="co"># original figure</span></span>
<span id="cb112-2"><a href="#cb112-2"></a>our_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(smoke_complete) <span class="sc">+</span></span>
<span id="cb112-3"><a href="#cb112-3"></a>  <span class="fu">aes</span>(<span class="at">x =</span> age_at_diagnosis, </span>
<span id="cb112-4"><a href="#cb112-4"></a>      <span class="at">y =</span> cigarettes_per_day, </span>
<span id="cb112-5"><a href="#cb112-5"></a>      <span class="at">color =</span> disease) <span class="sc">+</span></span>
<span id="cb112-6"><a href="#cb112-6"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb112-7"><a href="#cb112-7"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Cigarettes per Day versus Age at Diagnosis"</span>,</span>
<span id="cb112-8"><a href="#cb112-8"></a>       <span class="at">x =</span> <span class="st">"Age at Diagnosis"</span>,</span>
<span id="cb112-9"><a href="#cb112-9"></a>       <span class="at">y =</span> <span class="st">"Cigarettes Smoked per Day"</span>)</span>
<span id="cb112-10"><a href="#cb112-10"></a></span>
<span id="cb112-11"><a href="#cb112-11"></a>our_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="output_figs/unnamed-chunk-57-1.png" width="768"></p>
</div>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1"></a><span class="co"># modify tick values on x-axis</span></span>
<span id="cb113-2"><a href="#cb113-2"></a>our_plot <span class="ot">&lt;-</span> our_plot <span class="sc">+</span> </span>
<span id="cb113-3"><a href="#cb113-3"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">10000</span>, <span class="dv">20000</span>, <span class="dv">30000</span>))</span>
<span id="cb113-4"><a href="#cb113-4"></a></span>
<span id="cb113-5"><a href="#cb113-5"></a>our_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="output_figs/unnamed-chunk-57-2.png" width="768"></p>
</div>
</div>
</section>
<section id="mini-challenge-3" class="slide level2" data-number="8.4">
<h2><span class="header-section-number">8.4</span> Mini-challenge 3</h2>
<ul>
<li>How would you modify the <code>y</code>-axis to have the following breaks?</li>
</ul>
<blockquote>
<p>c(2, 4, 6, 8, 10)</p>
</blockquote>
<p>Hint: it’s not <code>scale_x_continuous</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1"></a>our_plot <span class="sc">+</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="better-labels" class="slide level2" data-number="8.5">
<h2><span class="header-section-number">8.5</span> Better Labels</h2>
<p>Another use for <code>scale_</code> functions is to improve the formatting on the axis tick labels.</p>
<ul>
<li>Suppose our <code>y</code>-axis was dollars instead of number of cigarettes.</li>
<li>We can supply <code>label_currency()</code> (from the <code>scales</code> package) as an argument to our <code>labels</code> argument in scale_y_continuous:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1"></a>our_plot <span class="sc">+</span></span>
<span id="cb115-2"><a href="#cb115-2"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_currency</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="output_figs/unnamed-chunk-59-1.png" width="768"></p>
</div>
</div>
<p>Other useful label_ functions for formatting labels:</p>
<ul>
<li><code>label_date()</code> - Lets you control the way dates are formatted on the axis</li>
<li><code>label_scientific()</code> - lets you format the labels with scientific notation</li>
<li><code>label_pvalue()</code> - formatting specific to p-values</li>
<li><code>label_percent()</code> - percent formatting</li>
</ul>
</section>
<section id="scale_color_manual---mapping-discrete-colors-to-categories" class="slide level2" data-number="8.6">
<h2><span class="header-section-number">8.6</span> scale_color_manual() - mapping discrete colors to categories</h2>
<ul>
<li><p>Last class we used <code>scale_*</code> functions for fill and color to change color palettes.</p></li>
<li><p>The <code>scale_color_manual()</code> function can be used to explicitly set colors by name, or using a built in palette.</p></li>
<li><p>If you want to explicitly name the colors values in your data set are mapped to, you can use the <code>values</code> argument of <code>scale_color_manual()</code></p>
<ul>
<li>See <a href="https://r-charts.com/colors/">Colors in R</a> for other named colors in R,</li>
<li>or this <a href="https://www.datanovia.com/en/blog/awesome-list-of-657-r-color-names/">longer list of named colors</a>):</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1"></a>our_plot <span class="sc">+</span></span>
<span id="cb116-2"><a href="#cb116-2"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb116-3"><a href="#cb116-3"></a>    <span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb116-4"><a href="#cb116-4"></a>      <span class="st">"LUSC"</span> <span class="ot">=</span> <span class="st">"limegreen"</span>,</span>
<span id="cb116-5"><a href="#cb116-5"></a>      <span class="st">"BLCA"</span> <span class="ot">=</span> <span class="st">"orange"</span>,</span>
<span id="cb116-6"><a href="#cb116-6"></a>      <span class="st">"CESC"</span> <span class="ot">=</span> <span class="st">"pink"</span></span>
<span id="cb116-7"><a href="#cb116-7"></a>    ),</span>
<span id="cb116-8"><a href="#cb116-8"></a>    <span class="at">name =</span> <span class="st">"Disease Category"</span> <span class="co"># optional argument, a way to name the legend</span></span>
<span id="cb116-9"><a href="#cb116-9"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="output_figs/unnamed-chunk-60-1.png" width="768"></p>
</div>
</div>
</section>
<section id="color-palettes" class="slide level2" data-number="8.7">
<h2><span class="header-section-number">8.7</span> Color Palettes</h2>
<ul>
<li>If you don’t want to meticulously control every color, you can use palettes from various packages.</li>
<li>A list of lots of palettes are listed on this github by <a href="https://github.com/EmilHvitfeldt/r-color-palettes">Emil Hvitfeldt</a>.</li>
</ul>
<p>Here’s one fun one: {ghibli} <a href="https://ewenme.github.io/ghibli/" class="uri">https://ewenme.github.io/ghibli/</a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1"></a><span class="co"># library(ghibli)</span></span>
<span id="cb117-2"><a href="#cb117-2"></a></span>
<span id="cb117-3"><a href="#cb117-3"></a><span class="fu">names</span>(ghibli_palettes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "MarnieLight1"    "MarnieMedium1"   "MarnieDark1"     "MarnieLight2"   
 [5] "MarnieMedium2"   "MarnieDark2"     "PonyoLight"      "PonyoMedium"    
 [9] "PonyoDark"       "LaputaLight"     "LaputaMedium"    "LaputaDark"     
[13] "MononokeLight"   "MononokeMedium"  "MononokeDark"    "SpiritedLight"  
[17] "SpiritedMedium"  "SpiritedDark"    "YesterdayLight"  "YesterdayMedium"
[21] "YesterdayDark"   "KikiLight"       "KikiMedium"      "KikiDark"       
[25] "TotoroLight"     "TotoroMedium"    "TotoroDark"     </code></pre>
</div>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1"></a>ghibli_palettes[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>] <span class="co"># first three palettes</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$MarnieLight1
&lt;colors&gt;
#95918EFF #AF9699FF #80C7C9FF #8EBBD2FF #E3D1C3FF #B3DDEBFF #F3E8CCFF 

$MarnieMedium1
&lt;colors&gt;
#28231DFF #5E2D30FF #008E90FF #1C77A3FF #C5A387FF #67B8D6FF #E9D097FF 

$MarnieDark1
&lt;colors&gt;
#15110EFF #2F1619FF #004749FF #0E3B52FF #635143FF #335D6BFF #73684CFF </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1"></a><span class="fu">ghibli_palette</span>(<span class="st">"PonyoMedium"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="output_figs/unnamed-chunk-62-1.png" width="768"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1"></a>our_plot <span class="sc">+</span></span>
<span id="cb122-2"><a href="#cb122-2"></a>    <span class="fu">scale_color_manual</span>(</span>
<span id="cb122-3"><a href="#cb122-3"></a>      <span class="at">values =</span> <span class="fu">ghibli_palette</span>(<span class="st">"PonyoMedium"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="output_figs/unnamed-chunk-63-1.png" width="768"></p>
</div>
</div>
<ul>
<li>Remember, if we want to do this with <code>our_boxplot</code>,
<ul>
<li>the scale we want to manipulate is not <code>color</code>, but <code>fill</code>,</li>
<li>so we need to use <code>scale_fill_manual()</code></li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1"></a>our_boxplot <span class="sc">+</span></span>
<span id="cb123-2"><a href="#cb123-2"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">ghibli_palette</span>(<span class="st">"MononokeMedium"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="output_figs/unnamed-chunk-64-1.png" width="768"></p>
</div>
</div>
</section>
<section id="mini-challenge-4" class="slide level2" data-number="8.8">
<h2><span class="header-section-number">8.8</span> Mini-challenge 4</h2>
<p>Pick one of the palettes from <code>ghibli</code> and use it to modify <code>our_plot</code> (hint: use <code>?ghibli_palette</code>):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1"></a>our_plot <span class="sc">+</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="scale_color_gradient" class="slide level2" data-number="8.9">
<h2><span class="header-section-number">8.9</span> <code>scale_color_gradient()</code></h2>
<p>We’ve talked about variables with discrete values, but what about variables with continuous values?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1"></a><span class="fu">ggplot</span>(smoke_complete) <span class="sc">+</span></span>
<span id="cb125-2"><a href="#cb125-2"></a>  <span class="fu">aes</span>(<span class="at">x =</span> age_at_diagnosis, </span>
<span id="cb125-3"><a href="#cb125-3"></a>      <span class="at">y =</span> cigarettes_per_day, </span>
<span id="cb125-4"><a href="#cb125-4"></a>      <span class="at">color =</span> year_of_birth) <span class="sc">+</span></span>
<span id="cb125-5"><a href="#cb125-5"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb125-6"><a href="#cb125-6"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Cigarettes per Day versus Age at Diagnosis"</span>,</span>
<span id="cb125-7"><a href="#cb125-7"></a>       <span class="at">x =</span> <span class="st">"Age at Diagnosis"</span>,</span>
<span id="cb125-8"><a href="#cb125-8"></a>       <span class="at">y =</span> <span class="st">"Cigarettes Smoked per Day"</span>,</span>
<span id="cb125-9"><a href="#cb125-9"></a>       <span class="at">color =</span> <span class="st">"Year of Birth"</span>) <span class="sc">+</span></span>
<span id="cb125-10"><a href="#cb125-10"></a>  <span class="fu">scale_color_gradient</span>(<span class="at">low =</span> <span class="st">"pink"</span>, <span class="at">high=</span><span class="st">"blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="output_figs/unnamed-chunk-66-1.png" width="768"></p>
</div>
</div>
</section>
<section id="color-palettes-viridis" class="slide level2" data-number="8.10">
<h2><span class="header-section-number">8.10</span> Color Palettes: Viridis</h2>
<p>A built in palette in <code>ggplot2</code> is based on the colorblind friendly palettes in the <a href="https://cran.r-project.org/web/packages/viridis/vignettes/intro-to-viridis.html">viridis</a> package (we don’t need the package to use these scales as newer versions of <code>ggplot2</code> import them).</p>
<p>We have built in functions that use these:</p>
<ul>
<li>For discrete values:
<ul>
<li><code>scale_color_viridis_d()</code></li>
<li><code>scale_fill_viridis_d()</code></li>
</ul></li>
<li>For continuous values:
<ul>
<li><code>scale_color_viridis_c()</code></li>
<li><code>scale_fill_viridis_c()</code></li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1"></a>our_plot <span class="sc">+</span></span>
<span id="cb126-2"><a href="#cb126-2"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb126-3"><a href="#cb126-3"></a>  <span class="fu">scale_color_viridis_d</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="output_figs/unnamed-chunk-67-1.png" width="768"></p>
</div>
</div>
<ul>
<li>Four options are available: “magma” (or “A”), “inferno” (or “B”), “plasma” (or “C”), “viridis” (or “D”, the default option) and “cividis” (or “E”).</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1"></a>our_plot <span class="sc">+</span></span>
<span id="cb127-2"><a href="#cb127-2"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb127-3"><a href="#cb127-3"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">"A"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="output_figs/unnamed-chunk-68-1.png" width="768"></p>
</div>
</div>
</section>
<section id="more-palettes" class="slide level2" data-number="8.11">
<h2><span class="header-section-number">8.11</span> More Palettes</h2>
<ul>
<li>The <a href="https://emilhvitfeldt.github.io/paletteer/"><code>{paletteer}</code></a> package has a lot of other palettes from many packages included all in one:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1"></a>our_plot <span class="sc">+</span> </span>
<span id="cb128-2"><a href="#cb128-2"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb128-3"><a href="#cb128-3"></a>  paletteer<span class="sc">::</span><span class="fu">scale_color_paletteer_d</span>(<span class="at">palette =</span> <span class="st">"impressionist.colors::irissen"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="output_figs/unnamed-chunk-69-1.png" width="768"></p>
</div>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1"></a>our_plot <span class="sc">+</span> </span>
<span id="cb129-2"><a href="#cb129-2"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb129-3"><a href="#cb129-3"></a>  paletteer<span class="sc">::</span><span class="fu">scale_color_paletteer_d</span>(<span class="st">"ggthemes::Tableau_10"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="output_figs/unnamed-chunk-69-2.png" width="768"></p>
</div>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1"></a><span class="co"># View(palettes_d_names) for all palettes</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Remember we can save this (by default, the last plot created):</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1"></a><span class="fu">ggsave</span>(<span class="st">"part4/output_figs/gg_myplot.jpg"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section>
<section id="practice" class="title-slide slide level1 center" data-number="9">
<h1><span class="header-section-number">9</span> Practice</h1>
<p>Try out chapters <a href="https://r-bootcamp.netlify.app/chapter2" target="_blank">2</a> and <a href="https://r-bootcamp.netlify.app/chapter3" target="_blank">3</a> in the R-Bootcamp:</p>
<p><br></p>
<p>If you are interested in learning more about <code>ggplot</code>:</p>
<ul>
<li>Documentation for all <code>ggplot</code> features is available <a href="https://ggplot2.tidyverse.org" target="_blank">here</a>.</li>
<li><a href="https://ggplot2-book.org/" target="_blank">ggplot2: Elegant Graphics for Data Analysis (3e)</a></li>
<li>Posit’s <a href="https://github.com/rstudio/cheatsheets/blob/main/data-visualization.pdf" target="_blank">ggplot cheat sheet</a> that is really handy!</li>
<li><a href="http://zevross.com/blog/2014/08/04/beautiful-plotting-in-r-a-ggplot2-cheatsheet-3/" target="_blank">Beautiful plotting in R: A ggplot2 cheatsheet</a> is also handy, because it organizes ggplot2 commands by task.</li>
<li><a href="https://exts.ggplot2.tidyverse.org/gallery/" target="_blank">ggplot2 extensions gallery</a> is a visual list of add on packages for ggplot</li>
</ul>
</section>

<section id="post-class-survey" class="title-slide slide level1 center" data-number="10">
<h1><span class="header-section-number">10</span> Post Class Survey</h1>
<p>Please fill out the <a href="https://ohsu.ca1.qualtrics.com/jfe/form/SV_2f0SKdTYUo80aRo">post-class survey</a>.</p>
<p>Your responses are anonymous in that I separate your names from the survey answers before compiling/reading.</p>
<p>You may want to review previous years’ feedback <a href="https://niederhausen.github.io/BSTA_526_W26/survey_feedback_previous_years">here</a>.</p>
</section>

<section id="acknowledgements" class="title-slide slide level1 center" data-number="11">
<h1><span class="header-section-number">11</span> Acknowledgements</h1>
<ul>
<li>Part 4 is based on the BSTA 504 Winter 2023 course, taught by Jessica Minnier.
<ul>
<li>I made modifications to update the material from RMarkdown to Quarto, and streamlined/edited content for slides.</li>
<li>Also made updates for new R functions/ specifications</li>
</ul></li>
<li>Minnier’s Acknowledgements:
<ul>
<li>Written by Aaron Coyner and Ted Laderas and Jessica Minnier.</li>
<li>Based on the Intro to R materials from fredhutch.io and the R-Bootcamp</li>
</ul></li>
</ul>

<div class="footer footer-default">

</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1100,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
              // target, if specified
              link.setAttribute("target", "_blank");
          }
        }
    });
    </script>
    

</body></html>