---
title: "1: Functions and vectors"
pagetitle: "1: Functions and vectors"
subtitle: "BSTA 526: R Programming for Health Data Science"
author: "Your name here - update this!!!!"
institute: "OHSU-PSU School of Public Health"
date: "1/08/2026"
date-modified: "today"
format: 
  # html:
  #   link-external-newwindow: true
  #   toc: true
  #   toc_float:
  #     collapsed: false
  #   number-sections: true
  #   number-depth: 4
  #   theme: minty
  #   self-contained: true
  #   html-math-method: mathjax
  revealjs:
      incremental: false
      scrollable: true
      chalkboard: true
      theme: [../sky_modified_smaller_font_B526_W26.scss]
      width:  1100 #1200 # 1050 #default 1050; ipad 3:4, 1600
      # height: 825 #900 #800 #default 700; 788 for 3:4, 1200
      slide-number: true
      number-sections: true
      number-depth: 4
      link-external-newwindow: true
      html-math-method: mathjax
execute:
  echo: true
editor_options: 
  chunk_output_type: console
---

```{r}
#| label: setup
#| include: false
knitr::opts_chunk$set(echo = TRUE)
# alternative to library()
pacman::p_load(vembedr, 
               stringr) 
```

## Before you get started

*   Please save a copy of this as `part01_b526_YOURNAMEorINITIALS.qmd` and work from that. 
    *   This way, you'll have the original as a reference just in case.

*   Also, the first time you try something, try to ***type*** **out the answer rather than copying and pasting**. 
    *   It will help you understand what's going on, because it forces you to read the code. 
    *   However, if you find yourself getting too in the weeds with typing during class, copying and pasting works too! Practice typing on your own.



# Introduction to R

## R/RStudio

Link to video: <https://youtu.be/oFmjHxl28H0>

-   Winter 2025:
    -   Start at minute 2. The first 2 minutes are on using RStudio server in the Cloud, which we are not using.
    -   This video provides an overview of what the difference parts of the RStudio interface are used for.
    -   Replace references to RMarkdown (or .Rmd) with Quarto (or .qmd).

```{r}
vembedr::embed_youtube("oFmjHxl28H0", width = 600, height=300)
```

-   A good reference built into RStudio is `Help -> Cheatsheets -> RStudio IDE cheat sheet`

-   A nice summary of the RStudio anatomy is here:

![](https://jminnier-berd-r-courses.netlify.app/01-intro-r-eda/img/RStudio_Anatomy.svg) [Here are some useful gifs about customizing the RStudio panels](https://www.pipinghotdata.com/posts/2020-09-07-introducing-the-rstudio-ide-and-r-markdown/#background)

## RStudio projects

> How do you eat an elephant?
>
> One bite at a time. We will go over topics related to RStudio/file management again and again this class, so don't worry if it is confusing at first.

-   We will be using RStudio projects.
    -   We will talk about them again later, but for now,
    -   open RStudio by double clicking on the .Rproj file for part 1 (`part_01.Rproj`)

[You may read this for more info](https://r4ds.hadley.nz/workflow-scripts.html#projects), and watch this short video on creating new projects:

Link to video: <https://youtu.be/D22THnoPA6w>

```{r}
vembedr::embed_youtube("D22THnoPA6w", width = 600, height=300)
```

## Quarto (.qmd)

-   See intro to Quarto from [BSTA 511 Week 1](https://niederhausen.github.io/BSTA_511_F23/weeks/week_01.html)
    -   Can view slides as html, pdf, or "continuous" webpage.

### Create a Quarto file

-   See BSTA 511/611 Day 1 section on [Create a Quarto file](https://niederhausen.github.io/BSTA_511_F23/slides_md/Day01_bsta511_md.html#create-a-quarto-file-.qmd).

### Markdown for "word processing"

-   The Quarto (qmd) document uses *markdown* language for text outside of code chunks.
-   Some markdown resources:
    -   BSTA 511/611 Day 1 [notes on markdown](https://niederhausen.github.io/BSTA_511_F23/slides_md/Day01_bsta511_md.html#formatting-text)
    -   [Official Quarto webpage on markdown basics](https://quarto.org/docs/authoring/markdown-basics.html)
    -   From BSTA 504: [Read more about markdown here](https://sph-r-programming-2022.netlify.app/reference/markdown/).
        -   Skip the last two sections on Front matter and Citations, since these are different for Quarto.

## Code chunks

Link to video: <https://youtu.be/0iETdE7WkqU>

```{r}
vembedr::embed_youtube("0iETdE7WkqU", width = 600, height=300)
```

The grey box below is a code chunk:

```{r}
# basic math
4 + 5 
```

-   Everything that starts with a `#` is called a *comment* and is not code that runs. It is useful for making notes for yourself.
-   Below the comment is the actual code.
    -   How do we run the code?

Try this one out. It's the same code as above, but with no spaces. Does it still run?

```{r}
# same code as above, without spaces
4+5
```

## Useful keyboard shortcuts (Tools â†’ Keyboard Shortcuts Help)

| action                                | mac                | windows/linux    |
|------------------------|------------------------|------------------------|
| Run code in qmd or script             | cmd + enter        | ctrl + enter     |
| Add code chunk                        | cmd + option + i   | ctrl + alt + i   |
| `<-`                                  | option + -         | alt + -          |
| interrupt currently running code      | esc                | esc              |
| in console, go to previously run code | up/down            | up/down          |
| `%>%`                                 | cmd + shift + m    | ctrl + shift + m |
| search files                          | cmd + shift + f    | ctrl + shift + f |
| render qmd                            | cmd + shift + k    | ctrl + shift + k |
| run entire code chunk                 | cmd + option + c   | ctrl + alt + c   |
| keyboard shortcut help                | option + shift + k | alt + shift + k  |

([see full list](https://support.rstudio.com/hc/en-us/articles/200711853-Keyboard-Shortcuts))

# Using functions

Link to video: <https://youtu.be/aQPOhhLinZM>

```{r}
vembedr::embed_youtube("aQPOhhLinZM", width = 600, height=300)
```

Below is an example of an R function:

```{r}
# using a function: rounding numbers
round(3.14)
pi
round(pi)
```

R functions can have multiple arguments

```{r}
# using a function with more arguments
round(x = 3.14, digits = 1)
```

Do we have to "name" the arguments?

## Getting Help

Learn more about the `round()` function with `?round`:

```{r}
?round
```

-   We can also type `?round` in the Console instead of including it in a code chunk.

```{r}
# can switch order of arguments (if you name them)
round(digits = 1, x = 3.14)
```

> You may notice that boxes pop up as you type. These represent RStudio's attempts to guess what you're typing and share additional options.

There are many ways to get help. The more you learn how to get help, the easier your coding life will be. Here's a list of options:

-   Google "question + rcran" (i.e "hist rcran" or "make a boxplot ggplot")
-   Google error in quotes (i.e. "Evaluation error: invalid type (closure) for variable '\*\*\*'")
-   Search [RStudio community](https://community.rstudio.com/) (now called Posit)
-   Search [Stack Overflow #r tag](https://stackoverflow.com/questions/tagged/r)
-   Search [github](https://github.com/search/advanced?q=language:R) for your function name to see examples or search the error
-   Use generative AI ([ChatGPT](https://chat.openai.com/), [Perplexity](https://www.perplexity.ai/), etc.)

Post a question somewhere friendly:

-   [RStudio community](https://community.rstudio.com/)
    -   to pick on my friend/coworker Emile, [an example](https://community.rstudio.com/t/levels-returns-null-for-a-tibble/110693)
-   [R for Data Science Online Learning Community](https://www.rfordatasci.com/) - join the slack channel
-   [twitter #rstats](https://twitter.com/search?q=%23rstats&src=typd)
    -   or `#rstats` on other social media platforms

## Challenge 1

-   What does the function `hist` do?
    -   What are its main arguments?
    -   How did you determine this?

```{r}

```

-   Tricky bonus: what about `+`, which is actually a function?

```{r}

```

# Common errors

## "Object not found"

This happens when text is entered for a non-existent variable (object)

```{r}
#| eval: false
hello
```

Can be due to missing quotes

```{r}
#| eval: false
install.packages(dplyr)
```

or misspellings (**R is case-sensitive**)!

## Incomplete commands

-   In the console:
    -   When the console is waiting for a new command, the prompt line begins with \>
        -   If the console prompt is +, then a previous command is incomplete
        -   You can finish typing the command in the console window
        -   If stressed and confused, press ESC many times (ESC = ESCAPE ME OUT OF HERE)
-   In a code chunk:
    -   R will let you know there is an error with a red circle containing a white X (see below).
        -   *Note that all code chunks below this one will still have the red error circles until you fix the code.*
    -   What happens if you try to run the code below?

```{r}
#| eval: false
3 + (2*6
```

Change `#| eval: false` above to `#| eval: true` after you fix the code error.

## "could not find function"

-   This can happen when you are calling a function but haven't loaded the package that it "lives" in.
-   For example, the function `day()` being used below is from the `lubridate` package.
    -   *What error do we get when we run the code?*

```{r}
#| eval: false
day("2025-01-09")
```

How do we fix this code?

```{r}
# either specify the package in front of ::function()
lubridate::day("2025-01-09")

# or load the package first (preferably at beginning of script)
library(lubridate)
day("2025-01-09")
```

Or, maybe there was a misspelling...

```{r}
#| eval: false
dsy("2025-01-09")
```

# Assigning objects with `<-`

Link to video: <https://youtu.be/pW9wkwob1Es>

```{r}
vembedr::embed_youtube("pW9wkwob1Es", width = 600, height=300)
```

-   `<-` is the primary assignment operator in R
-   Some naming conventions in R
    -   Objects cannot start with a number
    -   Object names are case sensitive
    -   No spaces in object names

```{r}
# assigning value to an object
weight_kg <- 55
```

-   Now that the object has been assigned, we can reference that object by running its name:

```{r}
# recall object
weight_kg
```

-   We can also use the object as a variable:

```{r}
# multiple an object (convert kg to lb)
2.2 * weight_kg
```

-   We can create a new object (variable) based on the existing one:

```{r}
# assign weight conversion to object
weight_lb <- 2.2 * weight_kg
```

-   Note that the code above only saves the value for `weight_lb`, but it doesn't show us what the value is.
-   To see what the value is, you can
    -   Check the Environment tab (this is not reproducible though)
    -   Add `()` around the whole line of code to also see the value:

```{r}
# added parentheses to see value of weight_lb in output
(weight_lb <- 2.2 * weight_kg)
```

-   Below we assign a new value to `weight_kg`
    -   *Did this change the value of `weight_lb`?*

```{r}
# reassign new value to an object
weight_kg <- 100
```

> You can think of the names of objects like sticky notes. You have the option to place the sticky note (name) on any value you choose. You can pick up the sticky note and place it on another value, but you need to explicitly tell R when you want values assigned to certain objects.

## Removing objects

-   You can clear the entire environment using the button at the top of the Environment panel with a picture of a broom.
    -   This may seem extreme, but don't worry! We can re-create all the work we've already done by running each line of code again.
-   To remove an individual object, use the `remove()` function:

```{r}
# remove object
remove(weight_lb) 
```

## Challenge 2

What is the value of each item at each step? (Hint, you can see the value of an object by typing in the name of the object, such as with the `mass` line below.)

```{r}
mass <- 47.5            # 1. mass?
mass
width  <- 122             # 2. width?
mass <- mass * 2.0      # 3. mass?
width  <- width - 20        #4.  width?
mass_index <- mass/width  # 5. mass_index?
```

Make your answers here:

1.  

2.  

3.  

4.  

5.  

# Vectors

Link to video: <https://youtu.be/0qLgfpvzBqI>

```{r}
vembedr::embed_youtube("0qLgfpvzBqI", width = 600, height=300)
```

## Creating vectors

-   `c` is for combine or concatenate

```{r}
# assign vector
ages <- c(50, 55, 60, 65) 

# recall vector
ages
```

## Learning things about vectors

```{r}
# how many things are in the object?
length(ages)
```

```{r}
# what type of object?
class(ages)
```

```{r}
# performing functions with vectors
mean(ages)
range(ages)
```

## Character vectors

```{r}
# vector of body parts
organs <- c("lung", "prostate", "breast")
```

In the example above, each word within the vector is encased in quotation marks, indicating these are *character data*, rather than object names.

## Challenge 3

Please answer the following questions about `organs`:

1.  How many values are in `organs`?
2.  What type of object is `organs`?

Answers here:

1.  

2.  

# Object (data) types and Vectors

-   **character**: sometimes referred to as string data, tend to be surrounded by quotes
-   **numeric**: real numbers (decimals), sometimes referred to as "double"
-   integer: a subset of numeric in which numbers are stored as integers
-   **logical**: Boolean data (`TRUE` and `FALSE`)
-   **dates**: can save data as seconds, hours, days, months, years, or combinations thereof. Recommend lubridate package for this.
-   complex: complex numbers with real and imaginary parts (e.g., 1 + 4i)
-   raw: bytes of data (machine readable, but not human readable)

## Challenge 4

-   R tends to handle interpreting data types in the background of most operations.
-   The following code is designed to cause some unexpected results in R.
    -   *What is unusual about each of the following objects?*

```{r}
#| eval: false
num_char <- c(1, 2, 3, "a")
num_logical <- c(1, 2, 3, TRUE)
char_logical <- c("a", "b", "c", TRUE)
tricky <- c(1, 2, 3, "4")
hola <- c("hi", "guten tag", hello)
```

# Manipulating vectors

Link to video: <https://youtu.be/J0y8Dtvm7bQ>

```{r}
vembedr::embed_youtube("J0y8Dtvm7bQ",  width = 600, height=300)
```

## Adding values to vectors

```{r}
ages

# add a value to end of vector
(ages <- c(ages, 90) )
```

```{r}
# add value at the beginning
(ages <- c(30, ages))
```

## Extracting (or excluding) values from vectors

```{r}
# extracting second value
organs[2] 
```

```{r}
# excluding second value
organs[-2] 
```

```{r}
# extracting first and third values
organs[c(1, 3)] 
```

# Missing data

```{r}
vembedr::embed_youtube("r8RFoTXDs_U")
```

-   `NA` indicates a missing value in R.
-   *`NA` is not a character!!!*

```{r}
# create a vector with missing data
heights <- c(2, 4, 4, NA, 6)
```

-   What happens when we try to calculate the mean or max of a vector with missing data?

```{r}
# calculate mean and max on vector with missing data
mean(heights)
max(heights)
```

-   How do we fix this?

```{r}
# add argument to remove NA
mean(heights, na.rm = TRUE)
max(heights, na.rm = TRUE)
```

-   Or, can use `na.omit` - *be careful with this!!*

```{r}
# remove incomplete cases
na.omit(heights) 
```

```{r}
mean(na.omit(heights))
```

## Challenge 5

Complete the following tasks after creating this vector (Note: there are multiple solutions):

1.  Remove NAs on `more_heights` (assign it to the object `more_heights_complete`)
2.  Calculate the `median()` of `more_heights_complete`

```{r}
# create vector
more_heights <- c(63, 69, 60, 65, NA, 68, 61, 70, 61, 59, 64, 69, 63, 63, NA, 72, 65, 64, 70, 63, 65)
# remove NAs


# calculate the median


```

# Vectorization

-   Most of R's functions are "vectorized"
-   This means that the function will operate on all elements of a vector without needing to use other advanced programming tools such as for loops (more on that later).

We can see this when we try to add vectors together:

```{r}
x <- 1:4
y <- 6:9
z <- x + y
z
```

All mathematical and logical operators are vectorized functions:

```{r}
z^2
z + 1
z == 9
z > 9
x / y
```

But other common functions are as well:

```{r}
z <- x / y
round(z, 2)
```

```{r}
z <- c("no", "nope", "maybe")
paste(z, "hi")
stringr::str_replace(z, "o","7")
```

# R packages

-   Packages are add-ons that contain functions and/or data.
-   Usually the functions in a package are related to a certain type of data task or analysis method.
-   **You only need to install packages once**.
-   You need to "load" the packages that you need for your code
    -   every time you start R AND
    -   you need to have the code to load them at the top of your qmd or R script.

## Loading packages: library()`or`pacman::p_load()\`

-   You can load packages with the `library()` function or `p_load()` function in the `pacman` package.

-   The following code loads two packages, though the `tidyverse` package is actually a suite of many packages.

    -   *This code assumes you have already installed the packages!!!*

```{r}
library(tidyverse)
library(janitor)

# OR do this:
pacman::p_load(tidyverse, janitor) 
```

# Wrapping up

Today we covered

-   R/RStudio and Quarto
-   Functions
-   Working with objects (vectors) and determining data types
-   Missing data
-   Vectorization
-   R Packages

# Post Class Survey

Please fill out the [post-class survey](https://ohsu.ca1.qualtrics.com/jfe/form/SV_dhbhugCU2UnjYOi). I will summarize muddiest and clearest points before each class. Your responses are anonymous in that I separate your names from the survey answers before compiling/reading.

# Acknowledgements

-   This Intro to R was copied from the BSTA 504 Winter 2023 course, taught by Jessica Minnier. I made minor modifications; primarily to update the material from RMarkdown to Quarto, and adding links to an introduction to Quarto from BSTA 511/611.
-   Minnier's Acknowledgements:
    -   This intro to R was adapted from material from Kate Hertweck's Intro to R course from <http://fredhutch.io>, the [Intro to R OCTRI BERD course](https://jminnier-berd-r-courses.netlify.app/01-intro-r-eda/01_intro_r_eda_part1.html) I taught with Meike Niederhausen, and of course, [Ted Laderas' 2021 materials](https://sph-r-programming.netlify.app/).
